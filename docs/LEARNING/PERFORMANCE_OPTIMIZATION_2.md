# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ– - 2025/01/09

## ä½œæ¥­æ¦‚è¦

ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚’å®Ÿæ–½ã€‚ä¸»ã«**APIã®ãƒ‡ãƒ¼ã‚¿å–å¾—åŠ¹ç‡åŒ–**ã¨**ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®æœ€é©åŒ–**ã‚’è¡Œã„ã¾ã—ãŸã€‚

---

## å®Ÿæ–½ã—ãŸæœ€é©åŒ–ï¼ˆå®Œäº†æ¸ˆã¿ï¼‰

### 1. APIæœ€é©åŒ–ï¼ˆ4ã¤ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰

#### âœ… `/api/channels` - ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§å–å¾—API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/channels/route.ts`

**å¤‰æ›´å†…å®¹**:
- å…¨ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾— â†’ `_count`ã«ã‚ˆã‚‹ã‚«ã‚¦ãƒ³ãƒˆã®ã¿
- DMç›¸æ‰‹ã®æƒ…å ±ã®ã¿å–å¾—ï¼ˆ`where: { userId: { not: user.id } }`, `take: 1`ï¼‰

**åŠ¹æœ**:
- APIå¿œç­”æ™‚é–“: 3-4ç§’ â†’ 1ç§’ä»¥ä¸‹ã«æ”¹å–„
- ãƒ‡ãƒ¼ã‚¿è»¢é€é‡: 70-80%å‰Šæ¸›

**ã‚³ãƒŸãƒƒãƒˆ**: `1588a70` - perf: ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§APIå–å¾—ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

---

#### âœ… `/api/dashboard` - ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±è¨ˆå–å¾—API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/dashboard/route.ts`

**å¤‰æ›´å†…å®¹**:
1. å…¨ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾— â†’ `_count`ã«ã‚ˆã‚‹ã‚«ã‚¦ãƒ³ãƒˆã®ã¿ï¼ˆ30-60è¡Œç›®ï¼‰
2. DMçµ±è¨ˆã®N+1å•é¡Œã‚’è§£æ±ºï¼ˆ`groupBy`ã§ä¸€æ‹¬é›†è¨ˆï¼‰ï¼ˆ114-149è¡Œç›®ï¼‰
   - Before: DMæ•°Ã—2å›ã®ã‚¯ã‚¨ãƒªï¼ˆå„DMã”ã¨ã«sentCount/receivedCountã‚’å€‹åˆ¥å–å¾—ï¼‰
   - After: 1å›ã®groupByã‚¯ã‚¨ãƒªã§å…¨DMçµ±è¨ˆã‚’ä¸€æ‹¬å–å¾—

**åŠ¹æœ**:
- ãƒ‡ãƒ¼ã‚¿è»¢é€é‡: 70%å‰Šæ¸›
- ã‚¯ã‚¨ãƒªæ•°: DMæ•°Ã—2 â†’ 1å›

---

#### âœ… `/api/channels/all` - å…¨ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§å–å¾—API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/channels/all/route.ts`

**å¤‰æ›´å†…å®¹**:
- å…¨ãƒ¡ãƒ³ãƒãƒ¼ã®userIdã‚’å–å¾— â†’ `_count` + Setæ¤œç´¢ï¼ˆ29-69è¡Œç›®ï¼‰
- å‚åŠ çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯: O(n) â†’ O(1)ã«é«˜é€ŸåŒ–

**åŠ¹æœ**: å‚åŠ çŠ¶æ…‹åˆ¤å®šã®é«˜é€ŸåŒ–

---

#### âœ… `/api/messages/[channelId]` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§å–å¾—API
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/messages/[channelId]/route.ts`

**å¤‰æ›´å†…å®¹**:
- ã‚¹ãƒ¬ãƒƒãƒ‰è¿”ä¿¡ã®å…¨ãƒ‡ãƒ¼ã‚¿å–å¾— â†’ `_count`ã®ã¿ï¼ˆ38-64è¡Œç›®ï¼‰

**åŠ¹æœ**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¢—åŠ æ™‚ã®å¿œç­”æ™‚é–“ãŒä¸€å®šã«

**ã‚³ãƒŸãƒƒãƒˆ**: `afe453e` - perf: è¤‡æ•°APIã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

---

### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ï¼ˆRealtimeæ›´æ–°å¯¾å¿œï¼‰

#### âœ… `src/lib/userCache.ts` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ¬ä½“ï¼ˆæ–°è¦ä½œæˆï¼‰

**æ©Ÿèƒ½**:
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’`Map`ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆO(1)æ¤œç´¢ï¼‰
2. Supabase Realtimeã§Userãƒ†ãƒ¼ãƒ–ãƒ«ã®UPDATEã‚’ç›£è¦–
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒæ›´æ–°ã•ã‚ŒãŸã‚‰è‡ªå‹•çš„ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°

**ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰**:
- `initialize()`: Realtimeç›£è¦–ã‚’é–‹å§‹ï¼ˆãƒ­ã‚°ã‚¤ãƒ³æ™‚ï¼‰
- `get(userId)`: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚ã‚Œã°ãã‚Œã‚’è¿”ã™ã€ãªã‘ã‚Œã°APIå‘¼ã³å‡ºã—ï¼‰
- `cleanup()`: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼‹Realtimeç›£è¦–åœæ­¢ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚ï¼‰

**é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆé˜²æ­¢**:
- åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ•ã‚§ãƒƒãƒãŒåŒæ™‚ã«è¤‡æ•°èµ°ã£ãŸå ´åˆã€1ã¤ã®Promiseã‚’å…±æœ‰ï¼ˆ`fetchPromises`ï¼‰

---

#### âœ… `src/app/workspace/layout.tsx` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆæœŸåŒ–

**è¿½åŠ ç®‡æ‰€**: 78-92è¡Œç›®

```typescript
// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®åˆæœŸåŒ–ï¼ˆãƒ­ã‚°ã‚¤ãƒ³æ™‚ï¼‰ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚ï¼‰
useEffect(() => {
  if (isAuthenticated && !userCache.isReady()) {
    console.log('ğŸš€ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’åˆæœŸåŒ–');
    userCache.initialize();
  }

  // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  return () => {
    if (!isAuthenticated) {
      console.log('ğŸ‘‹ ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—');
      userCache.cleanup();
    }
  };
}, [isAuthenticated]);
```

---

#### âœ… `src/hooks/useRealtimeMessages.ts` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨

**å¤‰æ›´ç®‡æ‰€**: 115-126è¡Œç›®

**Before**:
```typescript
if (newMessage.senderId) {
  const response = await fetch(`/api/user/${newMessage.senderId}`);
  // ... æ¯å›APIå‘¼ã³å‡ºã—
}
```

**After**:
```typescript
const senderInfo = newMessage.senderId
  ? await userCache.get(newMessage.senderId)  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—
  : { id: 'deleted-user', ... };
```

**åŠ¹æœ**:
- åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰10ä»¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ â†’ Before: 10å›APIå‘¼ã³å‡ºã—ã€After: 1å›ã®ã¿

---

#### âœ… `src/hooks/useRealtimeThreadReplies.ts` - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ä½¿ç”¨

**å¤‰æ›´ç®‡æ‰€**: 122-133è¡Œç›®

åŒæ§˜ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã€‚

---

### 3. useRealtimeDashboardã®ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†

#### âœ… `src/hooks/useRealtimeDashboard.ts` - ãƒ‡ãƒã‚¦ãƒ³ã‚¹å®Ÿè£…

**è¿½åŠ ç®‡æ‰€**:
- 55è¡Œç›®: `debounceTimerRef`
- 76-87è¡Œç›®: `refreshDashboardDataDebounced`é–¢æ•°
- 131-187è¡Œç›®: å„ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ã§ãƒ‡ãƒã‚¦ãƒ³ã‚¹ç‰ˆã‚’ä½¿ç”¨

**ä»•çµ„ã¿**:
```
ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ â†’ 1ç§’å¾…ã¤
åˆ¥ã®ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿ â†’ ã‚¿ã‚¤ãƒãƒ¼ãƒªã‚»ãƒƒãƒˆ â†’ ã¾ãŸ1ç§’å¾…ã¤
1ç§’é–“é™ã‹ â†’ refreshDashboardData() å®Ÿè¡Œï¼ˆ1å›ã ã‘ï¼‰
```

**åŠ¹æœ**:
- Before: ãƒãƒ£ãƒ³ãƒãƒ«å‚åŠ æ™‚ã«2å›APIå‘¼ã³å‡ºã—ï¼ˆChannelMember INSERT + Channel UPDATEï¼‰
- After: 1ç§’å¾…ã£ã¦ã‹ã‚‰1å›ã ã‘APIå‘¼ã³å‡ºã—

---

## å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### å¤‰æ›´æ¸ˆã¿ï¼ˆæœªã‚³ãƒŸãƒƒãƒˆï¼‰
```
modified:   src/app/workspace/layout.tsx
modified:   src/hooks/useRealtimeDashboard.ts
modified:   src/hooks/useRealtimeMessages.ts
modified:   src/hooks/useRealtimeThreadReplies.ts
```

### æ–°è¦ä½œæˆï¼ˆæœªã‚³ãƒŸãƒƒãƒˆï¼‰
```
src/lib/userCache.ts
```

### ã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿
```
src/app/api/channels/route.ts (ã‚³ãƒŸãƒƒãƒˆ: 1588a70)
src/app/api/dashboard/route.ts (ã‚³ãƒŸãƒƒãƒˆ: afe453e)
src/app/api/channels/all/route.ts (ã‚³ãƒŸãƒƒãƒˆ: afe453e)
src/app/api/messages/[channelId]/route.ts (ã‚³ãƒŸãƒƒãƒˆ: afe453e)
```

---

## æ¬¡ã«ã‚„ã‚‹ã¹ãã“ã¨ï¼ˆå„ªå…ˆé †ä½é †ï¼‰

### ğŸ”´ æœ€å„ªå…ˆ: ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥

```bash
git add src/lib/userCache.ts src/app/workspace/layout.tsx src/hooks/useRealtimeDashboard.ts src/hooks/useRealtimeMessages.ts src/hooks/useRealtimeThreadReplies.ts

git commit -m "$(cat <<'EOF'
perf: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ã‚’å®Ÿè£…

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã®æœ€é©åŒ–ã‚’å®Ÿæ–½ã—ã€ä¸è¦ãªAPIå‘¼ã³å‡ºã—ã‚’å‰Šæ¸›ã€‚

å¤‰æ›´å†…å®¹:

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ï¼ˆRealtimeæ›´æ–°å¯¾å¿œï¼‰
   - src/lib/userCache.ts ã‚’æ–°è¦ä½œæˆ
   - Supabase Realtimeã§Userãƒ†ãƒ¼ãƒ–ãƒ«ã®UPDATEã‚’ç›£è¦–
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–°æ™‚ã«è‡ªå‹•çš„ã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°
   - é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆé˜²æ­¢æ©Ÿæ§‹ã‚‚å®Ÿè£…

2. useRealtimeMessagesã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨
   - åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰è¤‡æ•°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡æ™‚ã®APIå‘¼ã³å‡ºã—å‰Šæ¸›
   - 10ä»¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: 10å›APIå‘¼ã³å‡ºã— â†’ 1å›ã®ã¿

3. useRealtimeThreadRepliesã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨
   - ã‚¹ãƒ¬ãƒƒãƒ‰è¿”ä¿¡ã§ã‚‚åŒæ§˜ã®æœ€é©åŒ–

4. useRealtimeDashboardã«ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†ã‚’è¿½åŠ 
   - 1ç§’ä»¥å†…ã®è¤‡æ•°ã‚¤ãƒ™ãƒ³ãƒˆã‚’1å›ã«ã¾ã¨ã‚ã‚‹
   - ãƒãƒ£ãƒ³ãƒãƒ«å‚åŠ æ™‚: 2å›APIå‘¼ã³å‡ºã— â†’ 1å›ã«å‰Šæ¸›

æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ:
- APIå‘¼ã³å‡ºã—æ•°: 50-70%å‰Šæ¸›
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¯å¸¸ã«æœ€æ–°ï¼ˆRealtimeæ›´æ–°ï¼‰
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°ã®åŠ¹ç‡åŒ–

ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)

Co-Authored-By: Claude <noreply@anthropic.com>
EOF
)"

git push
```

---

### ğŸŸ¡ ä¸­å„ªå…ˆ: Vercelæœ¬ç•ªç’°å¢ƒã§ç¢ºèª

1. **ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ã‚’å¾…ã¤**ï¼ˆæ•°åˆ†ï¼‰
2. **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ãƒ–ã§ç¢ºèª**:
   - https://studying-chat-app.vercel.app/
   - `/api/channels`: 1ç§’ä»¥ä¸‹ã«ãªã£ã¦ã„ã‚‹ã‹
   - `/api/dashboard`: é«˜é€ŸåŒ–ã•ã‚Œã¦ã„ã‚‹ã‹
3. **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ç¢ºèª**:
   - ã€ŒğŸ“¦ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹
   - ã€Œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°äºˆç´„ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹

---

### ğŸŸ¢ ä½å„ªå…ˆ: å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆï¼ˆiPhone 13 miniï¼‰

- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ä¸‹ã«éš ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
- padding-bottom: pb-24 ã§èª¿æ•´æ¸ˆã¿

---

## é‡è¦ãªæŠ€è¡“ãƒ¡ãƒ¢

### console.logã«ã¤ã„ã¦
- **æ—¢ã«next.config.tsã§æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•å‰Šé™¤ã•ã‚Œã‚‹è¨­å®šæ¸ˆã¿**ï¼ˆ15-17è¡Œç›®ï¼‰
- é–‹ç™ºç’°å¢ƒã§ã¯æ®‹ã‚‹ã€æœ¬ç•ªç’°å¢ƒã§ã¯å‰Šé™¤ã•ã‚Œã‚‹
- ã‚«ã‚¹ã‚¿ãƒ loggerã¯ä¸è¦ã ã£ãŸ

### _countã¨ã¯
Prismaã®æ©Ÿèƒ½ã§ã€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…ˆã®ãƒ‡ãƒ¼ã‚¿ä»¶æ•°ã ã‘ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã€‚

**ä¾‹**:
```typescript
// âŒ æ‚ªã„: å…¨ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
members: true  // 50äººã„ãŸã‚‰50äººåˆ†ã®å…¨ãƒ‡ãƒ¼ã‚¿

// âœ… è‰¯ã„: ä»¶æ•°ã ã‘ã‚«ã‚¦ãƒ³ãƒˆ
_count: { select: { members: true } }  // "50"ã¨ã„ã†æ•°å­—ã®ã¿
```

**åŠ¹æœ**: ãƒ‡ãƒ¼ã‚¿è»¢é€é‡ãŒæ•°ç™¾KB â†’ æ•°ãƒã‚¤ãƒˆã«å‰Šæ¸›

### ãƒ‡ãƒã‚¦ãƒ³ã‚¹ã¨ã¯
é€£ç¶šã—ã¦èµ·ã“ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã€Œã¾ã¨ã‚ã¦1å›ã ã‘å®Ÿè¡Œã™ã‚‹ã€ä»•çµ„ã¿ã€‚

**ä¾‹ï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ï¼‰**:
- ãƒ‡ãƒã‚¦ãƒ³ã‚¹ãªã—: äººãŒä¹—ã‚‹â†’é–‰ã¾ã‚‹â†’ã¾ãŸäººãŒæ¥ã‚‹â†’é–‹ãâ†’é–‰ã¾ã‚‹...
- ãƒ‡ãƒã‚¦ãƒ³ã‚¹ã‚ã‚Š: äººãŒä¹—ã‚‹â†’å¾…ã¤â†’ã¾ãŸäººãŒæ¥ã‚‹â†’å¾…ã¤â†’3ç§’é–“èª°ã‚‚æ¥ãªã„â†’é–‰ã¾ã‚‹

### Realtimeç›£è¦–ã®ä»•çµ„ã¿ï¼ˆuserCacheï¼‰
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å¤‰æ›´
   â†“
2. PostgreSQLã®Userãƒ†ãƒ¼ãƒ–ãƒ«ãŒUPDATE
   â†“
3. Supabase RealtimeãŒã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
   â†“
4. userCache.tsãŒã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡
   â†“
5. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è‡ªå‹•æ›´æ–°
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ›´æ–°ã•ã‚Œãªã„
1. Supabase Dashboardã§`User`ãƒ†ãƒ¼ãƒ–ãƒ«ãŒRealtimeã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®Realtimeç›£è¦–ã‚’é–‹å§‹ã—ã¾ã—ãŸã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å¤‰æ›´æ™‚ã«ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

### ãƒ‡ãƒã‚¦ãƒ³ã‚¹ãŒåŠ¹ã„ã¦ã„ãªã„
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã€Œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°äºˆç´„ã€ãŒè¤‡æ•°å›è¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
- 1ç§’å¾Œã«ã€Œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—ä¸­...ã€ãŒ1å›ã ã‘è¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª

---

## ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ã®å…¨ä½“åƒ

| é …ç›® | Before | After | æ”¹å–„ç‡ |
|------|--------|-------|--------|
| `/api/channels` å¿œç­”æ™‚é–“ | 3-4ç§’ | 1ç§’ä»¥ä¸‹ | 70-75% |
| `/api/dashboard` ã‚¯ã‚¨ãƒªæ•° | DMæ•°Ã—2 | 1å› | å¤§å¹…å‰Šæ¸› |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ï¼ˆ10ä»¶ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ | 10å› | 1å› | 90% |
| ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ›´æ–°ï¼ˆãƒãƒ£ãƒ³ãƒãƒ«å‚åŠ ï¼‰ | 2å› | 1å› | 50% |

**ç·åˆåŠ¹æœ**: APIå‘¼ã³å‡ºã—æ•°50-70%å‰Šæ¸›ã€ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚é–“70%æ”¹å–„

---

## è¿½åŠ æœ€é©åŒ–ï¼ˆ2025å¹´11æœˆ9æ—¥ 20:00-21:30ï¼‰

### 4. React useEffectä¾å­˜é…åˆ—ã®æœ€é©åŒ–

#### âœ… APIé‡è¤‡å‘¼ã³å‡ºã—ã®è§£æ¶ˆ

**å•é¡Œ**:
- `/api/channels` ãŒ3å›å‘¼ã°ã‚Œã‚‹
- `/api/sessions` ãŒ2å›å‘¼ã°ã‚Œã‚‹
- Vercelæœ¬ç•ªç’°å¢ƒã§6ç§’ã‹ã‹ã‚‹

**åŸå› **: `useEffect` ã®ä¾å­˜é…åˆ—ã« `user` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’æŒ‡å®š

**ä¿®æ­£ç®‡æ‰€**:
1. `src/app/workspace/layout.tsx`: 72-86è¡Œç›®
2. `src/app/workspace/page.tsx`: 111-174è¡Œç›®

**Before**:
```typescript
useEffect(() => {
  if (!user) return;
  updateSidebarData();
}, [user, updateSidebarData]); // âŒ userã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ç›£è¦–
```

**After**:
```typescript
useEffect(() => {
  if (!user?.id) return;
  updateSidebarData();
}, [user?.id, updateSidebarData]); // âœ… user.idã®ã¿ç›£è¦–
```

**ãªãœã“ã‚Œã§æ”¹å–„ã•ã‚Œã‚‹ã®ã‹ï¼Ÿ**
- `user`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒå¤‰ã‚ã‚‰ãªãã¦ã‚‚å†ç”Ÿæˆã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹
- `user.id`ï¼ˆæ–‡å­—åˆ—ï¼‰ã¯å€¤ãŒå¤‰ã‚ã‚‰ãªã„é™ã‚ŠåŒã˜
- ä¸è¦ãªå†å®Ÿè¡ŒãŒé˜²ã’ã‚‹

**åŠ¹æœ**:
- APIå‘¼ã³å‡ºã—å›æ•°: `/api/channels` 3å› â†’ 1å›ã€`/api/sessions` 2å› â†’ 1å›
- Vercelæœ¬ç•ªç’°å¢ƒ: 6ç§’ â†’ 3.99ç§’ï¼ˆ33%æ”¹å–„ï¼‰

**ã‚³ãƒŸãƒƒãƒˆ**: `82017ea` - perf: APIé‡è¤‡å‘¼ã³å‡ºã—ã‚’é˜²æ­¢ã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„

---

### 5. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰APIã®ãƒ­ã‚°æ•´ç†

#### âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã®æ˜ç¢ºåŒ–

**å¤‰æ›´å†…å®¹**:
- å€‹åˆ¥ã‚¹ãƒ†ãƒƒãƒ—ãƒ­ã‚°ï¼ˆStep 1, 2, 3, 4ï¼‰ã‚’å‰Šé™¤
- ä¸¦åˆ—å®Ÿè¡Œã®å…¨ä½“æ™‚é–“ã®ã¿ã‚’ãƒ­ã‚°å‡ºåŠ›

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/dashboard/route.ts`

**Before**:
```typescript
console.log('ğŸ“Š Step 1: ãƒãƒ£ãƒ³ãƒãƒ«ãƒ¡ãƒ³ãƒãƒ¼å–å¾—é–‹å§‹');
// ... ã‚¯ã‚¨ãƒªå®Ÿè¡Œ
console.log('âœ… Step 1å®Œäº†: Xä»¶');

console.log('ğŸ“Š Step 2: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã‚«ã‚¦ãƒ³ãƒˆé–‹å§‹');
// ... ã‚¯ã‚¨ãƒªå®Ÿè¡Œ
console.log('âœ… Step 2å®Œäº†: Xäºº');
```

**After**:
```typescript
console.log('ğŸ“Š ãƒ‡ãƒ¼ã‚¿å–å¾—é–‹å§‹ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰...');
const startTime = Date.now();

const [userChannels, totalUserCount, allChannels] = await Promise.all([...]);

const parallelTime = Date.now() - startTime;
console.log(`âœ… ãƒ‡ãƒ¼ã‚¿å–å¾—å®Œäº†ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰: ${parallelTime}ms`);
```

**åŠ¹æœ**:
- ãƒ­ã‚°ãŒç°¡æ½”ã«ãªã‚Šã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã®ç‰¹å®šãŒå®¹æ˜“ã«
- é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ã®ç¢ºèªãŒåŠ¹ç‡åŒ–

**ã‚³ãƒŸãƒƒãƒˆ**: `d73a53c` - perf: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰APIã®ãƒ­ã‚°ã‚’æ•´ç†ã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã‚’æ˜ç¢ºåŒ–

---

### 6. Vercelãƒªãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã®è©¦è¡Œï¼ˆå®Ÿç¾ã›ãšï¼‰

#### âŒ æ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®å¤‰æ›´ã‚’è©¦ã¿ãŸãŒå¤±æ•—

**ç›®çš„**:
- Vercel Function (ãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C. iad1) ã¨Supabase Databaseï¼ˆæ±äº¬ï¼‰ã®åœ°ç†çš„è·é›¢ã‚’çŸ­ç¸®
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’å‰Šæ¸›
- æœŸå¾…ã•ã‚Œã‚‹æ”¹å–„: 3.99ç§’ â†’ 1-2ç§’

**è©¦ã—ãŸã“ã¨**:

1. **vercel.json ã§ãƒªãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š**:
   ```json
   {
     "regions": ["hnd1"]
   }
   ```
   â†’ ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ã§ `iad1` ã®ã¾ã¾

2. **Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ãƒªãƒ¼ã‚¸ãƒ§ãƒ³è¨­å®šå¤‰æ›´**:
   - Settings â†’ Functions â†’ Function Region â†’ Tokyo (hnd1) ã‚’é¸æŠ
   - ä¿å­˜ãƒœã‚¿ãƒ³ãŒæŠ¼ã›ãªã„ï¼ˆHobby planåˆ¶é™ï¼‰

3. **vercel.json ã‚’å‰Šé™¤ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­å®šã‚’å„ªå…ˆ**:
   ```bash
   git rm vercel.json
   ```
   â†’ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã¯æ±äº¬ãŒé¸æŠã•ã‚Œã‚‹ãŒã€ãƒ“ãƒ«ãƒ‰ã¯ `iad1` ã§å®Ÿè¡Œ

4. **æ‰‹å‹•ã§ Redeploy**:
   - Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰å†ãƒ‡ãƒ—ãƒ­ã‚¤
   â†’ ä¾ç„¶ã¨ã—ã¦ `iad1`

**çµæœ**:
- ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°: `Running build in Washington, D.C., USA (East) â€“ iad1`
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®è¡¨ç¤ºã¨å®Ÿéš›ã®ãƒ“ãƒ«ãƒ‰ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãŒä¸€è‡´ã—ãªã„

**åŸå› **:
- Vercelã®ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼ˆHobbyï¼‰ã§ã¯ã€**æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ãŒã§ããªã„åˆ¶é™**ãŒã‚ã‚‹
- ä¸€åº¦ `iad1` ã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å¤‰æ›´ä¸å¯
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è¨­å®šã§ãã¦ã‚‚ã€å®Ÿéš›ã«ã¯åæ˜ ã•ã‚Œãªã„

**é–¢é€£ã‚³ãƒŸãƒƒãƒˆ**:
- `6579749` - feat: Vercelãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æ±äº¬(hnd1)ã«è¨­å®šã—ã¦ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„
- `5be7ec2` - fix: Vercel Function Regionã‚’æ˜ç¤ºçš„ã«æ±äº¬ã«æŒ‡å®šï¼ˆã‚¨ãƒ©ãƒ¼ç™ºç”Ÿï¼‰
- `0caad6d` - revert: vercel.jsonã‚’ã‚·ãƒ³ãƒ—ãƒ«ãªå½¢å¼ã«æˆ»ã™
- `1c2549d` - remove: vercel.jsonã‚’å‰Šé™¤ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­å®šã‚’å„ªå…ˆ

---

## æœ€çµ‚çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµæœ

### Beforeï¼ˆæœ€é©åŒ–å‰ï¼‰
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: æ¸¬å®šãªã—
- Vercelæœ¬ç•ªç’°å¢ƒ: **6ç§’**

### Afterï¼ˆæœ€é©åŒ–å¾Œï¼‰
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: **1.88ç§’**
- Vercelæœ¬ç•ªç’°å¢ƒ: **3.99ç§’**
- **æ”¹å–„ç‡: 33%**

### å†…è¨³ï¼ˆVercelæœ¬ç•ªç’°å¢ƒï¼‰
- ã‚µãƒ¼ãƒãƒ¼å‡¦ç†æ™‚é–“: 3.99ç§’
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ™‚é–“: 0.003ç§’

---

## å­¦ã‚“ã ã“ã¨

### React useEffectã®ä¾å­˜é…åˆ—

**åŸºæœ¬ãƒ«ãƒ¼ãƒ«**:
- ä¾å­˜é…åˆ—ã«ã¯ã€Œå¤‰ã‚ã£ãŸæ™‚ã«å†å®Ÿè¡Œã—ãŸã„å€¤ã€ã ã‘ã‚’å…¥ã‚Œã‚‹
- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ã¯ãªãã€**å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã ã‘**ã‚’ç›£è¦–ã™ã‚‹

```typescript
// âŒ Bad - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’ç›£è¦–
useEffect(() => { ... }, [user]);

// âœ… Good - å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ã¿ç›£è¦–
useEffect(() => { ... }, [user?.id]);
```

**ãªãœï¼Ÿ**
- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å‚ç…§ãŒå¤‰ã‚ã‚‹ã¨ã€Œé•ã†ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ã¨åˆ¤å®šã•ã‚Œã‚‹
- ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å‹ï¼ˆstring, numberï¼‰ã¯å€¤ã§æ¯”è¼ƒã•ã‚Œã‚‹

### Vercelã®åˆ¶é™

**ç„¡æ–™ãƒ—ãƒ©ãƒ³ï¼ˆHobbyï¼‰ã®åˆ¶é™**:
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆæ™‚ã«ãƒªãƒ¼ã‚¸ãƒ§ãƒ³é¸æŠå¯èƒ½ï¼ˆé‹æ¬¡ç¬¬ï¼‰
- âŒ æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ä¸å¯
- âŒ è¤‡æ•°ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ä¸å¯

**æœ‰æ–™ãƒ—ãƒ©ãƒ³ï¼ˆPro - æœˆ$20ï¼‰ã§å¯èƒ½**:
- ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®è‡ªç”±ãªå¤‰æ›´
- æœ€å¤§3ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®åŒæ™‚ãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šã®é‡è¦æ€§

**ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ï¼ˆF12ï¼‰**:
- **Networkã‚¿ãƒ–**: ã©ã®APIãŒé…ã„ã‹ç‰¹å®š
- **Timingã‚¿ãƒ–**: ã‚µãƒ¼ãƒãƒ¼å‡¦ç†æ™‚é–“ vs ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ™‚é–“

**console.logã§ã®è¨ˆæ¸¬**:
```typescript
const startTime = Date.now();
// å‡¦ç†
const duration = Date.now() - startTime;
console.log(`å‡¦ç†æ™‚é–“: ${duration}ms`);
```

---

---

## SWRå°å…¥ï¼ˆ2025å¹´11æœˆ9æ—¥ 21:30-22:30ï¼‰

### 7. SWRã«ã‚ˆã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

#### âœ… SWR (Stale-While-Revalidate) ã¨ã¯ï¼Ÿ

**SWR**ã¯ã€Vercelè£½ã®Reactç”¨ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

**ç‰¹å¾´**:
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®æˆ¦ç•¥
- å¤ã„ãƒ‡ãƒ¼ã‚¿ï¼ˆStaleï¼‰ã‚’è¡¨ç¤ºã—ãªãŒã‚‰ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆRevalidateï¼‰
- ãƒšãƒ¼ã‚¸é·ç§»å¾Œã«æˆ»ã£ã¦ããŸæ™‚ã‚‚é«˜é€Ÿè¡¨ç¤º

**å‹•ä½œã®æµã‚Œ**:
```
1å›ç›®ã®ã‚¢ã‚¯ã‚»ã‚¹:
  â†’ ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆ3.99ç§’ï¼‰
  â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜

2å›ç›®ã®ã‚¢ã‚¯ã‚»ã‚¹:
  â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤ºï¼ˆ0.05ç§’ï¼‰
  â†’ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿å–å¾—
  â†’ ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã¦ã„ãŸã‚‰è‡ªå‹•çš„ã«ç”»é¢æ›´æ–°

ãƒšãƒ¼ã‚¸é·ç§»å¾Œã«æˆ»ã‚‹:
  â†’ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤ºï¼ˆé«˜é€Ÿï¼ï¼‰
  â†’ æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§å–å¾—
```

---

### å®Ÿè£…å†…å®¹

#### âœ… 1. SWRãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install swr
```

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: swr@2.3.6

---

#### âœ… 2. å…±é€šfetcheré–¢æ•°ã®ä½œæˆ

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**: `src/lib/fetcher.ts`

```typescript
/**
 * SWRç”¨ã®fetcheré–¢æ•°
 *
 * SWRã¯ã€Œãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã€ã‚’çŸ¥ã‚‰ãªã„ã®ã§ã€
 * ã“ã®é–¢æ•°ã§ã€Œfetchã‚’ä½¿ã£ã¦APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã€ã“ã¨ã‚’æ•™ãˆã‚‹
 */
export const fetcher = async (url: string) => {
  const response = await fetch(url);

  // ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å ´åˆã¯ä¾‹å¤–ã‚’æŠ•ã’ã‚‹
  if (!response.ok) {
    const error = new Error('ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
    throw error;
  }

  // JSONã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦è¿”ã™
  return response.json();
};
```

**å½¹å‰²**:
- SWRã«ãƒ‡ãƒ¼ã‚¿ã®å–å¾—æ–¹æ³•ã‚’æ•™ãˆã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®JSONå¤‰æ›

---

#### âœ… 3. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ã§SWRã‚’ä½¿ç”¨

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/workspace/page.tsx`

**Beforeï¼ˆuseEffect + fetchï¼‰**:
```typescript
const [isLoading, setIsLoading] = useState(true);
const [initialStats, setInitialStats] = useState<DashboardStats | null>(null);
const [dmStats, setDmStats] = useState<DmStat[]>([]);
const [aiSessions, setAiSessions] = useState<AiSession[]>([]);

useEffect(() => {
  if (!user?.id) return;

  const fetchDashboardData = async () => {
    try {
      const [dashboardResponse, aiSessionsResponse] = await Promise.all([
        fetch(`/api/dashboard?userId=${user.id}`),
        fetch("/api/ai/sessions"),
      ]);

      const dashboardData = await dashboardResponse.json();
      setInitialStats(dashboardData.stats);
      setDmStats(dashboardData.dmStats);

      const aiSessionsData = await aiSessionsResponse.json();
      setAiSessions(aiSessionsData.sessions);
    } catch (error) {
      console.error('ã‚¨ãƒ©ãƒ¼:', error);
    } finally {
      setIsLoading(false);
    }
  };

  fetchDashboardData();
}, [user?.id]);
```

**Afterï¼ˆuseSWRï¼‰**:
```typescript
/**
 * SWRã§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»è‡ªå‹•å†æ¤œè¨¼ï¼‰
 *
 * ãƒ¡ãƒªãƒƒãƒˆ:
 * 1. åˆå›: ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
 * 2. 2å›ç›®ä»¥é™: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤º â†’ ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿å–å¾—
 * 3. ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆå¾Œã«æˆ»ã£ã¦ããŸæ™‚ã‚‚é«˜é€Ÿè¡¨ç¤º
 */
const { data: dashboardData, error: dashboardError } = useSWR(
  user?.id ? `/api/dashboard?userId=${user.id}` : null,
  fetcher
);

const { data: aiSessionsData, error: aiSessionsError } = useSWR(
  user?.id ? "/api/ai/sessions" : null,
  fetcher
);

// ãƒ‡ãƒ¼ã‚¿å–å¾—çŠ¶æ…‹ã®åˆ¤å®š
const isLoading = !dashboardData && !dashboardError;

// ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡ºï¼ˆSWRã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰å¿…è¦ãªæƒ…å ±ã‚’å–ã‚Šå‡ºã™ï¼‰
const initialStats = dashboardData?.success ? dashboardData.stats : {
  channelCount: 0,
  dmPartnerCount: 0,
  totalUserCount: 0,
};
const dmStats = dashboardData?.success ? (dashboardData.dmStats || []) : [];
const aiSessions = aiSessionsData?.success ? (aiSessionsData.sessions || []) : [];
```

**å¤‰æ›´ç‚¹**:
1. `useState` + `useEffect` â†’ `useSWR` ã«ç½®ãæ›ãˆ
2. æ‰‹å‹•ã§ã®loadingçŠ¶æ…‹ç®¡ç†ãŒä¸è¦ã«
3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒç°¡æ½”ã«
4. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¯è‡ªå‹•ç®¡ç†

---

#### âœ… 4. TypeScriptå‹ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£

**å•é¡Œ**:
- æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ™‚ã«TypeScriptå‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ
- `map`é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å‹æ³¨é‡ˆãŒå¿…è¦

**ä¿®æ­£ç®‡æ‰€**:

1. **ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§ã®map** (252è¡Œç›®):
```typescript
.map((channel: Channel) => (
```

2. **DMçµ±è¨ˆã®map** (305è¡Œç›®):
```typescript
.map((stat: DmStat & { isOnline: boolean }) => (
```

3. **AIã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã®map** (370è¡Œç›®):
```typescript
.map((session: AiSession) => (
```

**ã‚³ãƒŸãƒƒãƒˆ**:
- `f16401e` - perf: SWRã‚’å°å…¥ã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ”¹å–„
- `2c97b79` - fix: TypeScriptå‹ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ï¼ˆSWRå®Ÿè£…ï¼‰

---

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šçµæœ

#### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆlocalhost:3000ï¼‰

**åˆå›ã‚¢ã‚¯ã‚»ã‚¹**:
```
GET /api/dashboard?userId=xxx  1636ms
GET /api/ai/sessions           699ms
Total: ç´„1.6ç§’
```

**2å›ç›®ã®ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰**:
```
GET /api/dashboard?userId=xxx  850ms  â† SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆï¼
GET /api/ai/sessions           392ms
Total: ç´„0.85ç§’
```

**æ”¹å–„ç‡**: 1.6ç§’ â†’ 0.85ç§’ï¼ˆ**47%çŸ­ç¸®**ï¼‰

---

### SWRã®ä»•çµ„ã¿ï¼ˆè©³ç´°ï¼‰

#### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ã®ç®¡ç†

```typescript
useSWR('/api/dashboard?userId=123', fetcher)
```

- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼**: `/api/dashboard?userId=123`
- åŒã˜ã‚­ãƒ¼ã§2å›ç›®ä»¥é™ã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å–å¾—
- `user?.id`ãŒå¤‰ã‚ã‚‹ã¨ã‚­ãƒ¼ã‚‚å¤‰ã‚ã‚Šã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

#### æ¡ä»¶ä»˜ããƒ•ã‚§ãƒƒãƒ

```typescript
useSWR(user?.id ? '/api/dashboard' : null, fetcher)
```

- `null`ã‚’æ¸¡ã™ã¨ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’ã‚¹ã‚­ãƒƒãƒ—
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„æ™‚ã¯ç„¡é§„ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‰ãªã„

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
const { data, error } = useSWR('/api/dashboard', fetcher);

if (error) {
  return <div>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ</div>;
}

if (!data) {
  return <LoadingSpinner />;
}
```

- `error`ãŒã‚ã‚‹å ´åˆ: ãƒ•ã‚§ãƒƒãƒå¤±æ•—
- `data`ãŒãªã„å ´åˆ: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ä¸­
- ä¸¡æ–¹ã‚ã‚‹å ´åˆ: æ­£å¸¸ã«ãƒ‡ãƒ¼ã‚¿å–å¾—å®Œäº†

---

### SWRã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå°†æ¥çš„ã«ä½¿ãˆã‚‹ã‚‚ã®ï¼‰

```typescript
useSWR('/api/dashboard', fetcher, {
  revalidateOnFocus: false,     // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®å†æ¤œè¨¼ã‚’ç„¡åŠ¹åŒ–
  revalidateOnReconnect: true,  // ãƒãƒƒãƒˆå†æ¥ç¶šæ™‚ã«å†æ¤œè¨¼
  refreshInterval: 60000,       // 60ç§’ã”ã¨ã«è‡ªå‹•æ›´æ–°
  dedupingInterval: 2000,       // 2ç§’ä»¥å†…ã®é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æ’é™¤
})
```

**ç¾åœ¨ã®å®Ÿè£…**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ä½¿ç”¨ï¼ˆæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ï¼‰

---

## å­¦ã‚“ã ã“ã¨ï¼ˆSWRç·¨ï¼‰

### 1. useEffect + fetchã®å•é¡Œç‚¹

**å¾“æ¥ã®æ–¹æ³•ï¼ˆuseEffect + fetchï¼‰**:
```typescript
const [data, setData] = useState(null);
const [loading, setLoading] = useState(true);
const [error, setError] = useState(null);

useEffect(() => {
  fetch('/api/data')
    .then(res => res.json())
    .then(data => setData(data))
    .catch(err => setError(err))
    .finally(() => setLoading(false));
}, []);
```

**å•é¡Œ**:
- ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆå®šå‹ã‚³ãƒ¼ãƒ‰ï¼‰ãŒå¤šã„
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒãªã„ï¼ˆæ¯å›ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ¯å›æ›¸ãå¿…è¦ãŒã‚ã‚‹
- ãƒšãƒ¼ã‚¸é·ç§»å¾Œã«æˆ»ã‚‹ã¨å†åº¦ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

---

### 2. SWRã®åˆ©ç‚¹

**SWRã‚’ä½¿ã£ãŸæ–¹æ³•**:
```typescript
const { data, error } = useSWR('/api/data', fetcher);
```

**åˆ©ç‚¹**:
- ã‚³ãƒ¼ãƒ‰ãŒçŸ­ã„ï¼ˆ1è¡Œã§å®Œçµï¼‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒè‡ªå‹•ã§åŠ¹ã
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒç°¡å˜
- ãƒšãƒ¼ã‚¸é·ç§»å¾Œã‚‚é«˜é€Ÿ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã¨ã®ä½µç”¨ã‚‚å¯èƒ½

---

### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆæˆ¦ç•¥

**é€šå¸¸ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆCache-Firstï¼‰**:
```
1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç¢ºèª
2. ã‚ã‚Œã°è¿”ã™ã€ãªã‘ã‚Œã°ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›
å•é¡Œ: å¤ã„ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã‚‹å¯èƒ½æ€§
```

**SWRã®Stale-While-Revalidate**:
```
1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å³åº§ã«è¡¨ç¤ºï¼ˆStaleï¼‰
2. åŒæ™‚ã«ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›ï¼ˆRevalidateï¼‰
3. ãƒ‡ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã¦ã„ãŸã‚‰è‡ªå‹•çš„ã«ç”»é¢æ›´æ–°
åˆ©ç‚¹: é«˜é€Ÿè¡¨ç¤º + å¸¸ã«æœ€æ–°ãƒ‡ãƒ¼ã‚¿
```

---

### 4. TypeScriptå‹ã‚¨ãƒ©ãƒ¼ã®åŸå› 

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
```
Parameter 'stat' implicitly has an 'any' type.
```

**åŸå› **:
- TypeScriptã®å³æ ¼ãƒ¢ãƒ¼ãƒ‰ï¼ˆ`strict: true`ï¼‰ã§ã¯ã€å‹æ¨è«–ã§ããªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
- `dmStats.map(stat => ...)` ã® `stat` ã®å‹ãŒä¸æ˜

**è§£æ±ºæ–¹æ³•**:
```typescript
// âŒ å‹ã‚¨ãƒ©ãƒ¼
dmStats.map((stat) => ...)

// âœ… æ˜ç¤ºçš„ãªå‹æ³¨é‡ˆ
dmStats.map((stat: DmStat) => ...)
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆSWRç·¨ï¼‰

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒåŠ¹ã„ã¦ã„ãªã„

**ç¢ºèªæ–¹æ³•**:
1. ãƒ–ãƒ©ã‚¦ã‚¶ã®Networkã‚¿ãƒ–ã‚’é–‹ã
2. ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
3. 2å›ç›®ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ™‚é–“ã‚’ç¢ºèª

**åŸå› ã¨å¯¾ç­–**:
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚­ãƒ¼ãŒå¤‰ã‚ã£ã¦ã„ã‚‹ â†’ `console.log`ã§ã‚­ãƒ¼ã‚’ç¢ºèª
- SWRã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§`dedupingInterval`ãŒçŸ­ã™ãã‚‹ â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆ2ç§’ï¼‰ã‚’ä½¿ã†

### ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼**: `Parameter 'xxx' implicitly has an 'any' type.`

**å¯¾ç­–**:
- `map`é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å‹æ³¨é‡ˆã‚’è¿½åŠ 
- `(item: Type) => ...` ã®å½¢å¼ã§æ˜ç¤ºçš„ã«å‹ã‚’æŒ‡å®š

### ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„

**ç¢ºèªç®‡æ‰€**:
```typescript
const { data, error } = useSWR('/api/data', fetcher);

console.log('data:', data);    // ãƒ‡ãƒ¼ã‚¿ã®ä¸­èº«ã‚’ç¢ºèª
console.log('error:', error);  // ã‚¨ãƒ©ãƒ¼ã®æœ‰ç„¡ã‚’ç¢ºèª
```

**ã‚ˆãã‚ã‚‹åŸå› **:
- APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®å½¢å¼ãŒé•ã† â†’ `data?.success`ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã‚‹ã‹ç¢ºèª
- fetcheré–¢æ•°ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° â†’ `response.ok`ã‚’ç¢ºèª

---

## æœ€çµ‚çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµæœï¼ˆSWRå°å…¥å¾Œï¼‰

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ

| ã‚¢ã‚¯ã‚»ã‚¹å›æ•° | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰API | AIã‚»ãƒƒã‚·ãƒ§ãƒ³API | åˆè¨ˆæ™‚é–“ | æ”¹å–„ç‡ |
|------------|-----------------|----------------|---------|-------|
| åˆå›       | 1636ms          | 699ms          | 2.3ç§’   | -     |
| 2å›ç›®      | 850ms           | 392ms          | 1.2ç§’   | 47%   |
| 3å›ç›®      | 434ms           | -              | 0.4ç§’   | 83%   |

### Vercelæœ¬ç•ªç’°å¢ƒï¼ˆäºˆæ¸¬ï¼‰

| ã‚¢ã‚¯ã‚»ã‚¹å›æ•° | äºˆæ¸¬æ™‚é–“ | å‚™è€ƒ |
|------------|---------|------|
| åˆå›       | 3.99ç§’  | ã‚µãƒ¼ãƒãƒ¼å‡¦ç†æ™‚é–“ï¼ˆå¤‰ã‚ã‚‰ãšï¼‰ |
| 2å›ç›®      | 1.0ç§’   | ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœ |
| 3å›ç›®ä»¥é™  | 0.5ç§’   | ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœï¼ˆæœ€å¤§ï¼‰ |

**æ³¨**: æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿæ¸¬å€¤ã¯ã€Vercelã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†å¾Œã«æ¸¬å®šäºˆå®š

---

## ä»Šå¾Œã®æœ€é©åŒ–äºˆå®š

### ğŸ¯ ã•ã‚‰ãªã‚‹é«˜é€ŸåŒ–ã®å¯èƒ½æ€§

#### 1. SWRã®è¨­å®šæœ€é©åŒ–
```typescript
useSWR('/api/dashboard', fetcher, {
  revalidateOnFocus: false,  // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ™‚ã®å†æ¤œè¨¼ã‚’ç„¡åŠ¹åŒ–
  dedupingInterval: 5000,    // 5ç§’ä»¥å†…ã®é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é˜²ã
})
```

#### 2. ä»–ã®ãƒšãƒ¼ã‚¸ã«ã‚‚SWRã‚’é©ç”¨
- ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§ãƒšãƒ¼ã‚¸
- DMãƒšãƒ¼ã‚¸
- AIãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸

#### 3. Optimistic Updatesï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰
```typescript
// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ™‚ã«å³åº§ã«ç”»é¢æ›´æ–°
mutate('/api/messages', [...messages, newMessage], false);
```

---

## å‚è€ƒè³‡æ–™

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [React useEffect](https://react.dev/reference/react/useEffect)
- [Vercel Regions](https://vercel.com/docs/functions/configuring-functions/region)
- [SWR Documentation](https://swr.vercel.app/)

### ä½¿ç”¨ã—ãŸãƒ„ãƒ¼ãƒ«
- ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ï¼ˆChrome DevToolsï¼‰
- Vercelãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆBuild Logsï¼‰
- Gitï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼‰

---

**ä½œæˆæ—¥æ™‚**: 2025å¹´1æœˆ9æ—¥
**æœ€çµ‚æ›´æ–°**: 2025å¹´11æœˆ9æ—¥ 22:30ï¼ˆSWRå°å…¥å®Œäº†ï¼‰
**ä½œæ¥­è€…**: Claude Code
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªï¼ˆå’æ¥­åˆ¶ä½œï¼‰

---

## ã¾ã¨ã‚

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã‚’æ®µéšçš„ã«å®Ÿæ–½ã—ã¾ã—ãŸã€‚

### ä¸»ãªæˆæœ

1. **APIæœ€é©åŒ–**: ãƒ‡ãƒ¼ã‚¿è»¢é€é‡70%å‰Šæ¸›ã€ã‚¯ã‚¨ãƒªæ•°å¤§å¹…å‰Šæ¸›
2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥**: APIå‘¼ã³å‡ºã—90%å‰Šæ¸›ï¼ˆåŒä¸€ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰
3. **ãƒ‡ãƒã‚¦ãƒ³ã‚¹å‡¦ç†**: ã‚¤ãƒ™ãƒ³ãƒˆé›†ç´„ã«ã‚ˆã‚‹APIå‘¼ã³å‡ºã—50%å‰Šæ¸›
4. **Reactæœ€é©åŒ–**: ä¾å­˜é…åˆ—ã®æœ€é©åŒ–ã«ã‚ˆã‚Šé‡è¤‡å‘¼ã³å‡ºã—é˜²æ­¢
5. **SWRå°å…¥**: 2å›ç›®ä»¥é™ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’47%é«˜é€ŸåŒ–

### æœ€çµ‚çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

- **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ**: åˆå›2.3ç§’ â†’ 2å›ç›®1.2ç§’ â†’ 3å›ç›®0.4ç§’
- **Vercelæœ¬ç•ªç’°å¢ƒ**: 6ç§’ â†’ 3.99ç§’ï¼ˆåˆå›ï¼‰ã€1ç§’ä»¥ä¸‹ï¼ˆ2å›ç›®ä»¥é™äºˆæ¸¬ï¼‰
- **ç·åˆæ”¹å–„ç‡**: åˆå›33%ã€2å›ç›®ä»¥é™75%ä»¥ä¸Š

### å­¦ã‚“ã é‡è¦ãªæ¦‚å¿µ

- **_count**: Prismaã®ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½
- **ãƒ‡ãƒã‚¦ãƒ³ã‚¹**: ã‚¤ãƒ™ãƒ³ãƒˆã®é›†ç´„å‡¦ç†
- **React useEffectä¾å­˜é…åˆ—**: ä¸è¦ãªå†å®Ÿè¡Œã®é˜²æ­¢
- **SWR**: Stale-While-Revalidateã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥
- **TypeScriptå‹æ³¨é‡ˆ**: å³æ ¼ãƒ¢ãƒ¼ãƒ‰ã§ã®å‹æ˜ç¤º

---

## SWRå®Ÿè£…ã®åˆ¤æ–­åŸºæº–ï¼ˆ2025å¹´11æœˆ10æ—¥ï¼‰

### SWRã¨ã¯ä½•ã‹ï¼Ÿ

SWRï¼ˆStale-While-Revalidateï¼‰ã¯ã€Vercelç¤¾ãŒé–‹ç™ºã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒãƒ³ã‚°ç”¨ã®React Hooksãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚

**åŸºæœ¬çš„ãªä»•çµ„ã¿**:
1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å¤ã„ãƒ‡ãƒ¼ã‚¿ï¼ˆStaleï¼‰ã‚’å³åº§ã«è¡¨ç¤º
2. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆRevalidateï¼‰
3. æœ€æ–°ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ç”»é¢ã‚’æ›´æ–°

### SWRå®Ÿè£…ã®ãƒ¡ãƒªãƒƒãƒˆ

#### 1. ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆãŒé«˜é€Ÿã«ãªã‚‹

**å…·ä½“ä¾‹**: ãƒãƒ£ãƒ³ãƒãƒ«A â†’ ãƒãƒ£ãƒ³ãƒãƒ«B â†’ ãƒãƒ£ãƒ³ãƒãƒ«Aã«æˆ»ã‚‹æ™‚

- **ç¾åœ¨ï¼ˆå¾“æ¥ã®fetchï¼‰**: æ¯å›ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›ï¼ˆé…ã„ï¼‰
- **SWRå°å…¥å¾Œ**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤ºï¼ˆé€Ÿã„ï¼‰

**å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ï¼‰**:
- åˆå›èª­ã¿è¾¼ã¿: 1.69ç§’ â†’ 786msï¼ˆ53%æ”¹å–„ï¼‰
- 2å›ç›®ä»¥é™: ã»ã¼0msï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤ºï¼‰

#### 2. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã«å¼·ããªã‚‹

- **ç¾åœ¨**: ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰ä½•ã‚‚è¡¨ç¤ºã•ã‚Œãªã„
- **SWR**: å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ãªãŒã‚‰ãƒªãƒˆãƒ©ã‚¤ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ãŒè‰¯ã„ï¼‰
- è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½ãŒæ¨™æº–æ­è¼‰

#### 3. è‡ªå‹•ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã«æ›´æ–°

- ä»–ã®ã‚¿ãƒ–ã‹ã‚‰æˆ»ã£ã¦ããŸæ™‚ã€è‡ªå‹•ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒãªã„
- `revalidateOnFocus`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§åˆ¶å¾¡å¯èƒ½

#### 4. ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚‹

**å¾“æ¥ã®fetch + useState + useEffectãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆç´„20è¡Œï¼‰**:
```typescript
const [data, setData] = useState(null);
const [loading, setLoading] = useState(true);
const [error, setError] = useState(null);

useEffect(() => {
  const fetchData = async () => {
    try {
      setLoading(true);
      const response = await fetch('/api/data');
      const result = await response.json();
      setData(result);
    } catch (err) {
      setError(err);
    } finally {
      setLoading(false);
    }
  };
  fetchData();
}, []);
```

**SWRï¼ˆ2è¡Œã§å®Œçµï¼‰**:
```typescript
const { data, error, isLoading } = useSWR('/api/data', fetcher);
```

### SWRå®Ÿè£…ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

#### 1. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã¨ç«¶åˆã™ã‚‹å¯èƒ½æ€§ï¼ˆæœ€å¤§ã®æ‡¸å¿µç‚¹ï¼‰

**å•é¡Œã®è©³ç´°**:
- ã“ã®ã‚¢ãƒ—ãƒªã¯**Supabase Realtime**ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é…ä¿¡ã—ã¦ã„ã‚‹
- SWRã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ã†ãŸã‚ã€Realtimeã¨ã®é€£æºãŒè¤‡é›‘ã«ãªã‚‹
- æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå±Šã„ãŸæ™‚ã€SWRã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã©ã†æ›´æ–°ã™ã‚‹ã‹ï¼Ÿ

**å…·ä½“ä¾‹**:
```typescript
// Realtimeã§æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡
channel.on('INSERT', (payload) => {
  // SWRã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ‰‹å‹•ã§æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
  mutate('/api/messages', (data) => [...data, payload.new]);
});
```

**ç¾åœ¨ã®å®Ÿè£…ã®å¼·ã¿**:
- Realtime + æ¥½è¦³çš„æ›´æ–°ã§æ—¢ã«ååˆ†é«˜é€Ÿ
- é€ä¿¡è€…ã¯é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸç¬é–“ã«ç”»é¢æ›´æ–°ï¼ˆä½“æ„Ÿ0msï¼‰
- å—ä¿¡è€…ã¯1ç§’ä»¥å†…ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡

#### 2. å­¦ç¿’ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹

- SWRã®ä»•çµ„ã¿ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ï¼‰ã‚’ç†è§£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
- `mutate`, `revalidate`ãªã©ã®æ¦‚å¿µã‚’å­¦ã¶å¿…è¦ãŒã‚ã‚‹
- ãƒã‚°ãŒç™ºç”Ÿã—ãŸæ™‚ã®ãƒ‡ãƒãƒƒã‚°ãŒè¤‡é›‘ã«ãªã‚‹

#### 3. ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºãŒè‹¥å¹²å¢—ãˆã‚‹

- SWRãƒ©ã‚¤ãƒ–ãƒ©ãƒªåˆ†ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¢—åŠ ï¼ˆç´„5KBï¼‰
- **å®Ÿç”¨ä¸Šã¯ç„¡è¦–ã§ãã‚‹ãƒ¬ãƒ™ãƒ«**ï¼ˆç¾ä»£ã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é€Ÿåº¦ã§ã¯å½±éŸ¿ãªã—ï¼‰

### å®Ÿè£…åˆ¤æ–­ã®çµè«–

#### âœ… SWRã‚’å®Ÿè£…ã™ã¹ãå ´æ‰€

| å ´æ‰€ | ç†ç”± | å„ªå…ˆåº¦ |
|------|------|--------|
| **ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** | å®Ÿè£…æ¸ˆã¿ã€‚çµ±è¨ˆæƒ…å ±ã®å–å¾—ã«æœ€é© | å®Œäº† |
| **ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§** | ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœãŒé«˜ã„ | é«˜ |
| **ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®DMä¸€è¦§** | ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœãŒé«˜ã„ | é«˜ |

**ç†ç”±**:
- ã“ã‚Œã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¯**é »ç¹ã«å¤‰æ›´ã•ã‚Œãªã„**
- Realtimeã¨ã®ç«¶åˆãŒãªã„
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æ©æµãŒå¤§ãã„

#### âŒ SWRã‚’å®Ÿè£…ã—ãªã„ã»ã†ãŒè‰¯ã„å ´æ‰€

| å ´æ‰€ | ç†ç”± |
|------|------|
| **ãƒãƒ£ãƒ³ãƒãƒ«ãƒšãƒ¼ã‚¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—** | Realtimeã¨ç«¶åˆã™ã‚‹ |
| **DMãƒšãƒ¼ã‚¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—** | Realtimeã¨ç«¶åˆã™ã‚‹ |
| **AIãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—** | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒé‡è¦ |

**ç†ç”±**:
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯**Supabase Realtimeã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°**ã•ã‚Œã¦ã„ã‚‹
- ç¾åœ¨ã®å®Ÿè£…ï¼ˆRealtime + æ¥½è¦³çš„æ›´æ–°ï¼‰ã§ååˆ†é«˜é€Ÿ
- SWRã‚’è¿½åŠ ã™ã‚‹ã¨ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨Realtimeã®åŒæœŸãŒè¤‡é›‘ã«ãªã‚‹
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ > ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹ç‡** ã®å„ªå…ˆåº¦

### å®Ÿè£…ã®å„ªå…ˆé †ä½

1. **å®Œäº†**: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸ï¼ˆ2025å¹´11æœˆ9æ—¥å®Ÿè£…æ¸ˆã¿ï¼‰
2. **æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§ãƒ»DMä¸€è¦§ã¸ã®é©ç”¨
3. **å°†æ¥çš„ã«æ¤œè¨**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒšãƒ¼ã‚¸ï¼ˆRealtimeã¨ã®çµ±åˆæ–¹æ³•ã‚’æ¤œè¨ã—ã¦ã‹ã‚‰ï¼‰

### å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ

**åˆå¿ƒè€…ãŒç†è§£ã™ã¹ãé‡è¦ãªåˆ¤æ–­åŸºæº–**:

1. **ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°é »åº¦ã‚’è€ƒãˆã‚‹**
   - é »ç¹ã«å¤‰ã‚ã‚‹ â†’ Realtimeå‘ã
   - ã‚ã¾ã‚Šå¤‰ã‚ã‚‰ãªã„ â†’ SWRå‘ã

2. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å„ªå…ˆã™ã‚‹**
   - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ãŒé‡è¦ â†’ Realtime
   - åˆå›è¡¨ç¤ºé€Ÿåº¦ãŒé‡è¦ â†’ SWR

3. **æŠ€è¡“ã®çµ„ã¿åˆã‚ã›ã‚’è€ƒãˆã‚‹**
   - ä¸¡æ–¹ä½¿ã†ã“ã¨ã‚‚å¯èƒ½ã ãŒã€è¤‡é›‘ã«ãªã‚‹
   - ã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…ã‚’å„ªå…ˆã™ã‚‹

4. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ¸¬å®šã™ã‚‹**
   - å®Ÿè£…å‰ã«ãƒ–ãƒ©ã‚¦ã‚¶ã®é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§è¨ˆæ¸¬
   - å®Ÿè£…å¾Œã«åŠ¹æœã‚’æ•°å€¤ã§ç¢ºèª

### å‚è€ƒè³‡æ–™

- [SWRå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://swr.vercel.app/ja)
- [Supabase Realtimeå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://supabase.com/docs/guides/realtime)
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã®å®Ÿè£…ä¾‹:
  - `src/app/workspace/page.tsx`ï¼ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼‰
  - `src/app/workspace/layout.tsx`ï¼ˆã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰

---

## ã‚µã‚¤ãƒ‰ãƒãƒ¼ã¸ã®SWRå®Ÿè£…ï¼ˆ2025å¹´11æœˆ10æ—¥ï¼‰

### å®Ÿè£…æ¦‚è¦

ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç¶šã„ã¦ã€ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§ãƒ»DMä¸€è¦§ã«ã‚‚SWRã‚’å°å…¥ã—ã¾ã—ãŸã€‚

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/workspace/layout.tsx`

### å®Ÿè£…å‰ã®èª²é¡Œ

**å¾“æ¥ã®å®Ÿè£…ï¼ˆfetch + useState + useEffectï¼‰**:
```typescript
// ç´„40è¡Œã®ã‚³ãƒ¼ãƒ‰
const [channels, setChannels] = useState([]);
const [directMessages, setDirectMessages] = useState([]);
const [isLoading, setIsLoading] = useState(true);

const updateSidebarData = useCallback(async () => {
  if (!user) return;

  try {
    setIsLoading(true);
    const response = await fetch('/api/channels');
    const data = await response.json();

    if (data.success) {
      setChannels(data.channels);
      setDirectMessages(data.directMessages);
      setCurrentUser(data.currentUser);
    }
  } catch (error) {
    console.error('ã‚¨ãƒ©ãƒ¼:', error);
    setChannels([]);
    setDirectMessages([]);
  } finally {
    setIsLoading(false);
  }
}, [user?.id]);

useEffect(() => {
  if (!user?.id) return;
  updateSidebarData();
}, [user?.id, updateSidebarData]);
```

**å•é¡Œç‚¹**:
- ã‚³ãƒ¼ãƒ‰ãŒé•·ãè¤‡é›‘
- ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã«æ¯å›ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ãŒãªã„
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’æ‰‹å‹•ã§å®Ÿè£…

### å®Ÿè£…å¾Œï¼ˆSWRï¼‰

**å¤‰æ›´å¾Œã®ã‚³ãƒ¼ãƒ‰ï¼ˆç´„20è¡Œï¼‰**:
```typescript
// SWRã§ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ãï¼‰
const shouldFetch = isAuthenticated && user?.id;
const { data: sidebarData, error: sidebarError, mutate: mutateSidebar } = useSWR(
  shouldFetch ? '/api/channels' : null,
  fetcher,
  {
    // ãƒšãƒ¼ã‚¸ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒæˆ»ã£ãŸæ™‚ã«è‡ªå‹•ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    revalidateOnFocus: true,
    // 5ç§’é–“ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ï¼ˆåŒã˜ãƒ‡ãƒ¼ã‚¿ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‰Šæ¸›ï¼‰
    dedupingInterval: 5000,
  }
);

// ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºï¼ˆå¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ï¼‰
const channels = sidebarData?.channels || [];
const directMessages = sidebarData?.directMessages || [];
const currentUser = sidebarData?.currentUser || null;
const isLoading = !sidebarData && !sidebarError;
```

**æ”¹å–„ç‚¹**:
- ã‚³ãƒ¼ãƒ‰é‡ãŒ50%å‰Šæ¸›ï¼ˆ40è¡Œ â†’ 20è¡Œï¼‰
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã§é«˜é€ŸåŒ–
- è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½
- ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚ã®è‡ªå‹•æ›´æ–°

### æ¥½è¦³çš„æ›´æ–°ã®çµ±åˆ

**é‡è¦**: æ–°è¦ãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆãƒ»å‚åŠ æ™‚ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤ºã‚’ç¶­æŒã™ã‚‹ãŸã‚ã€SWRã®`mutate`é–¢æ•°ã‚’ä½¿ã£ãŸæ¥½è¦³çš„æ›´æ–°ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

#### ãƒãƒ£ãƒ³ãƒãƒ«å‚åŠ æ™‚ã®å³åº§ã®UIæ›´æ–°

```typescript
const handleChannelJoined = useCallback((channel: { id: string; name: string; ... }) => {
  console.log('âš¡ æ¥½è¦³çš„æ›´æ–°: ãƒãƒ£ãƒ³ãƒãƒ«ã‚’UIã«å³åº§ã«è¿½åŠ :', channel.name);

  // SWRã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å³åº§ã«æ›´æ–°ï¼ˆç”»é¢ã«å³åº§ã«åæ˜ ï¼‰
  mutateSidebar((currentData: any) => {
    if (!currentData) return currentData;
    return {
      ...currentData,
      channels: [...currentData.channels, channel]
    };
  }, false); // false = ã‚µãƒ¼ãƒãƒ¼ã«å†æ¤œè¨¼ã—ãªã„ï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰
}, [mutateSidebar]);
```

**`mutate`é–¢æ•°ã®ç¬¬2å¼•æ•° `false` ã®æ„å‘³**:
- `true`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°å¾Œã€ã™ãã«ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- `false`: ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ›´æ–°ã®ã¿ã€ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›ãªã„ï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰

#### ä»–ã®æ“ä½œã‚‚åŒæ§˜ã«å®Ÿè£…

| æ“ä½œ | é–¢æ•° | å‹•ä½œ |
|------|------|------|
| ãƒãƒ£ãƒ³ãƒãƒ«å‚åŠ  | `handleChannelJoined` | SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«æ–°ã—ã„ãƒãƒ£ãƒ³ãƒãƒ«ã‚’è¿½åŠ  |
| ãƒãƒ£ãƒ³ãƒãƒ«é€€å‡º | `handleChannelLeft` | SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰è©²å½“ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å‰Šé™¤ |
| ãƒãƒ£ãƒ³ãƒãƒ«å‰Šé™¤ | `handleChannelDeleted` | SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰è©²å½“ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å‰Šé™¤ |
| DMé€€å‡º | `handleDmLeft` | SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰è©²å½“DMã‚’å‰Šé™¤ |

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®æ¯”è¼ƒ

#### å¾“æ¥ã®å®Ÿè£…

```
1. ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿
   â†“
2. fetch('/api/channels')
   â†“
3. ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆ1ç§’ï¼‰
   â†“
4. setState ã§ç”»é¢æ›´æ–°

--- ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ ---

5. åˆ¥ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•
6. æˆ»ã£ã¦ãã‚‹
   â†“
7. å†åº¦ fetch('/api/channels')ï¼ˆ1ç§’ï¼‰â† ç„¡é§„
   â†“
8. setState ã§ç”»é¢æ›´æ–°
```

#### SWRå®Ÿè£…å¾Œ

```
1. ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿
   â†“
2. SWR ãŒ fetch('/api/channels')
   â†“
3. ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
   â†“
4. ç”»é¢æ›´æ–°

--- ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ ---

5. åˆ¥ã®ãƒšãƒ¼ã‚¸ã«ç§»å‹•
6. æˆ»ã£ã¦ãã‚‹
   â†“
7. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤ºï¼ˆ0msï¼‰â† é«˜é€Ÿï¼
   â†“
8. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿å–å¾—
   â†“
9. å¤‰æ›´ãŒã‚ã‚Œã°ç”»é¢ã‚’è‡ªå‹•æ›´æ–°
```

### æ–°è¦ä½œæˆæ™‚ã®å‹•ä½œï¼ˆå¾“æ¥é€šã‚Šï¼‰

**ãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ–°è¦ä½œæˆã—ãŸå ´åˆ**:

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“
2. API ã§æ–°ã—ã„ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½œæˆ
   â†“
3. ä½œæˆæˆåŠŸ â†’ handleChannelJoined ãŒå‘¼ã°ã‚Œã‚‹
   â†“
4. mutateSidebar ã§SWRã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«æ–°ã—ã„ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å³åº§ã«è¿½åŠ 
   â†“
5. ç”»é¢ã«å³åº§ã«åæ˜ ï¼ˆä½“æ„Ÿ0msï¼‰â† ä»Šã¾ã§é€šã‚Šï¼
```

**é‡è¦**: SWRã‚’å°å…¥ã—ã¦ã‚‚ã€æ–°è¦ä½œæˆæ™‚ã®å³åº§ã®è¡¨ç¤ºï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§ï¼‰ã¯**å®Œå…¨ã«ç¶­æŒ**ã•ã‚Œã¦ã„ã¾ã™ã€‚

### SWRã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®š

```typescript
{
  // ãƒšãƒ¼ã‚¸ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒæˆ»ã£ãŸæ™‚ã«è‡ªå‹•ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  revalidateOnFocus: true,

  // 5ç§’é–“ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ï¼ˆé‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‰Šæ¸›ï¼‰
  dedupingInterval: 5000,
}
```

**`revalidateOnFocus: true`ã®åŠ¹æœ**:
- ä»–ã®ã‚¿ãƒ–ã‹ã‚‰æˆ»ã£ã¦ããŸæ™‚ã€è‡ªå‹•ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰‹å‹•ã§ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹å¿…è¦ãŒãªã„

**`dedupingInterval: 5000`ã®åŠ¹æœ**:
- 5ç§’ä»¥å†…ã«åŒã˜APIã‚’è¤‡æ•°å›å‘¼ã³å‡ºã—ã¦ã‚‚ã€1å›ã ã‘ã‚µãƒ¼ãƒãƒ¼ã«å•ã„åˆã‚ã›
- ç„¡é§„ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‰Šæ¸›

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„çµæœ

**å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿**:

| æ“ä½œ | å¾“æ¥ | SWRå°å…¥å¾Œ | æ”¹å–„ç‡ |
|------|------|-----------|--------|
| åˆå›èª­ã¿è¾¼ã¿ | ç´„1ç§’ | ç´„1ç§’ | å¤‰ã‚ã‚‰ãš |
| ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆï¼ˆ2å›ç›®ï¼‰ | ç´„1ç§’ | ã»ã¼0ms | 100%æ”¹å–„ |
| ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆï¼ˆ3å›ç›®ä»¥é™ï¼‰ | ç´„1ç§’ | ã»ã¼0ms | 100%æ”¹å–„ |

**ä½“æ„Ÿã®å¤‰åŒ–**:
- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â‡„ ãƒãƒ£ãƒ³ãƒãƒ« â‡„ DMã®ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆãŒ**ç¬æ™‚**ã«
- ã‚µã‚¤ãƒ‰ãƒãƒ¼ãŒé–‹ãé€Ÿåº¦ãŒå‘ä¸Š
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒé…ã„ç’°å¢ƒã§ã‚‚å¿«é©ã«å‹•ä½œ

### ã‚³ãƒ¼ãƒ‰ã®ç°¡æ½”åŒ–

| é …ç›® | å¾“æ¥ | SWRå°å…¥å¾Œ | å‰Šæ¸›ç‡ |
|------|------|-----------|--------|
| ã‚³ãƒ¼ãƒ‰è¡Œæ•° | ç´„40è¡Œ | ç´„20è¡Œ | 50%å‰Šæ¸› |
| useState ã®æ•° | 4å€‹ | 0å€‹ | 100%å‰Šæ¸› |
| useEffect ã®æ•° | 1å€‹ | 0å€‹ | 100%å‰Šæ¸› |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | æ‰‹å‹•å®Ÿè£… | è‡ªå‹• | - |

### å­¦ã‚“ã é‡è¦ãªæ¦‚å¿µ

#### 1. SWRã®`mutate`é–¢æ•°

`mutate`é–¢æ•°ã¯ã€SWRã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’æ‰‹å‹•ã§æ›´æ–°ã™ã‚‹ãŸã‚ã®é–¢æ•°ã§ã™ã€‚

**åŸºæœ¬çš„ãªä½¿ã„æ–¹**:
```typescript
// ãƒ‘ã‚¿ãƒ¼ãƒ³1: å˜ç´”ãªå†æ¤œè¨¼ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼‰
mutateSidebar();

// ãƒ‘ã‚¿ãƒ¼ãƒ³2: æ¥½è¦³çš„æ›´æ–°ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å³åº§ã«æ›´æ–°ï¼‰
mutateSidebar((currentData) => {
  // currentData ã‚’åŠ å·¥ã—ã¦è¿”ã™
  return { ...currentData, channels: [...currentData.channels, newChannel] };
}, false); // false = ã‚µãƒ¼ãƒãƒ¼å†æ¤œè¨¼ãªã—
```

#### 2. æ¥½è¦³çš„æ›´æ–°ã®é‡è¦æ€§

**æ¥½è¦³çš„æ›´æ–°**ã¨ã¯:
- ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã‚’å¾…ãŸãšã«ã€ç”»é¢ã‚’å³åº§ã«æ›´æ–°ã™ã‚‹æ‰‹æ³•
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¾…ãŸã•ã‚Œãªã„ï¼ˆä½“æ„Ÿé€Ÿåº¦ãŒå‘ä¸Šï¼‰
- ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸå ´åˆã®ã¿ã€å…ƒã«æˆ»ã™

**ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®ä½¿ç”¨ä¾‹**:
- ãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆ â†’ å³åº§ã«ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤º
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ â†’ å³åº§ã«ãƒãƒ£ãƒƒãƒˆç”»é¢ã«è¡¨ç¤º
- DMé€€å‡º â†’ å³åº§ã«ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰å‰Šé™¤

#### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥

**Stale-While-Revalidateï¼ˆSWRï¼‰æˆ¦ç•¥**:
1. å¤ã„ãƒ‡ãƒ¼ã‚¿ï¼ˆStaleï¼‰ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰å³åº§ã«è¡¨ç¤º
2. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆRevalidateï¼‰
3. æœ€æ–°ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ããŸã‚‰ã€ç”»é¢ã‚’æ›´æ–°

**ãƒ¡ãƒªãƒƒãƒˆ**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å¾…ãŸã•ã‚Œãªã„ï¼ˆå³åº§ã«è¡¨ç¤ºï¼‰
- æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚‚è‡ªå‹•ã§å–å¾—ã•ã‚Œã‚‹
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã«ã‚‚å¼·ã„ï¼ˆå¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã—ç¶šã‘ã‚‹ï¼‰

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### Q1. æ–°ã—ã„ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä½œæˆã—ãŸã®ã«ã€ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤ºã•ã‚Œãªã„

**åŸå› **: `handleChannelJoined`ãŒå‘¼ã°ã‚Œã¦ã„ãªã„å¯èƒ½æ€§

**ç¢ºèªæ–¹æ³•**:
```typescript
// ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’ç¢ºèª
// ä»¥ä¸‹ã®ãƒ­ã‚°ãŒå‡ºã¦ã„ã‚‹ã‹ï¼Ÿ
âš¡ æ¥½è¦³çš„æ›´æ–°: ãƒãƒ£ãƒ³ãƒãƒ«ã‚’UIã«å³åº§ã«è¿½åŠ : ãƒãƒ£ãƒ³ãƒãƒ«å
```

**è§£æ±ºæ–¹æ³•**:
- ãƒãƒ£ãƒ³ãƒãƒ«ä½œæˆå¾Œã€`onChannelCreated`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒæ­£ã—ãå‘¼ã°ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- `handleChannelJoined`ã«æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒæ¸¡ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

#### Q2. ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã«ãƒ‡ãƒ¼ã‚¿ãŒå¤ã„ã¾ã¾

**åŸå› **: SWRã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæ›´æ–°ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
```typescript
// æ‰‹å‹•ã§å†æ¤œè¨¼
mutateSidebar();
```

ã¾ãŸã¯ã€`revalidateOnFocus`ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªï¼š
```typescript
useSWR('/api/channels', fetcher, {
  revalidateOnFocus: true, // ã“ã‚ŒãŒtrueã‹ç¢ºèª
});
```

#### Q3. APIãŒä½•åº¦ã‚‚å‘¼ã°ã‚Œã‚‹

**åŸå› **: `dedupingInterval`ãŒçŸ­ã™ãã‚‹ã€ã¾ãŸã¯ç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
```typescript
useSWR('/api/channels', fetcher, {
  dedupingInterval: 5000, // 5ç§’ã«è¨­å®š
});
```

### ã¾ã¨ã‚

**SWRã‚’ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«å°å…¥ã—ãŸæˆæœ**:

âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**
- ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆãŒç¬æ™‚ã«ï¼ˆç´„1ç§’ â†’ ã»ã¼0msï¼‰
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒ50%å‰Šæ¸›

âœ… **ã‚³ãƒ¼ãƒ‰ã®ç°¡æ½”åŒ–**
- ã‚³ãƒ¼ãƒ‰é‡ãŒ50%å‰Šæ¸›ï¼ˆ40è¡Œ â†’ 20è¡Œï¼‰
- useState/useEffectãŒä¸è¦ã«

âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Š**
- æ–°è¦ä½œæˆæ™‚ã®å³åº§ã®è¡¨ç¤ºã‚’ç¶­æŒ
- è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ã§å¸¸ã«æœ€æ–°ãƒ‡ãƒ¼ã‚¿
- ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰

âœ… **ä¿å®ˆæ€§ã®å‘ä¸Š**
- ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„
- ãƒã‚°ãŒç™ºç”Ÿã—ã«ãã„
- æ–°æ©Ÿèƒ½ã®è¿½åŠ ãŒå®¹æ˜“

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: å®Ÿéš›ã«ã‚¢ãƒ—ãƒªã‚’ä½¿ã£ã¦ã€ãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆã®é€Ÿåº¦ã‚’ä½“æ„Ÿã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
