# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå’æ¥­åˆ¶ä½œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼‰ã€‚Slack/Discord ã®ã‚ˆã†ãªæ©Ÿèƒ½ã‚’æŒã¤ Web ãƒ™ãƒ¼ã‚¹ã®ãƒãƒ£ãƒƒãƒˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã€‚

**æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯**:

- Next.js 15.5.4 (App Router) + React 19
- TypeScript
- Prisma ORM + PostgreSQL (Supabase)
- Supabase Auth (èªè¨¼)
- Supabase Realtime (WebSocket ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡)
- shadcn/ui + TailwindCSS 4
- Zustand (çŠ¶æ…‹ç®¡ç† - å°†æ¥çš„ã«å°å…¥äºˆå®š)
- OpenAI API (AI æ©Ÿèƒ½ - å°†æ¥çš„ã«å°å…¥äºˆå®š)

**ãƒªãƒã‚¸ãƒˆãƒª**: https://github.com/Ishikawa-Yutaka/studying-chat-app

**ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**: `/Users/Uni/Uni_MacBookAir/STUDYing/å’æ¥­åˆ¶ä½œâ€ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒª/studying-tech-chat-app/chat-app`

## Communication Style - é‡è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **åˆå¿ƒè€…å‘ã‘ã®å’æ¥­åˆ¶ä½œ** ã§ã™ã€‚ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚„ä½œæ¥­æ™‚ã¯ä»¥ä¸‹ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ï¼š
æ–‡å­—åŒ–ã‘ã™ã‚‹ã®ã§çµµæ–‡å­—ã¯ä½¿ç”¨ã—ãªã„

### å¿…é ˆäº‹é …

1. **ä½œæ¥­ã®ç›®çš„ã‚’æ˜ç¢ºã«èª¬æ˜ã™ã‚‹**

   - ã€Œãªãœã“ã®å¤‰æ›´ãŒå¿…è¦ãªã®ã‹ã€ã‚’å¿…ãšèª¬æ˜
   - ã€Œã“ã®æ©Ÿèƒ½ã¯ä½•ã®ãŸã‚ã«ã‚ã‚‹ã®ã‹ã€ã‚’ç†è§£ã§ãã‚‹ã‚ˆã†ã«èª¬æ˜

2. **ã‚³ãƒ¼ãƒ‰ã®ä¸å¯§ãªèª¬æ˜**

   - ç”Ÿæˆã—ãŸã‚³ãƒ¼ãƒ‰ã«ã¯æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆã‚’å¿…ãšä»˜ã‘ã‚‹
   - å„é–¢æ•°ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å½¹å‰²ã‚’æ˜è¨˜
   - è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã¯æ®µéšçš„ã«èª¬æ˜

3. **æŠ€è¡“ç”¨èªã®è£œè¶³**

   - å°‚é–€ç”¨èªã‚’ä½¿ã†å ´åˆã¯ç°¡å˜ãªèª¬æ˜ã‚’æ·»ãˆã‚‹
   - ä¾‹: ã€Œæ¥½è¦³çš„æ›´æ–°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã‚‰ã€ã‚µãƒ¼ãƒãƒ¼ã®å¿œç­”ã‚’å¾…ãŸãšã«å³åº§ã«ç”»é¢ã«è¡¨ç¤ºã™ã‚‹æ‰‹æ³•ï¼‰ã€

4. **ä½œæ¥­ãƒ—ãƒ­ã‚»ã‚¹ã®å¯è¦–åŒ–**
   - ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹ã€æ¬¡ã«ä½•ã‚’ã™ã‚‹ã®ã‹ã‚’æ˜ç¢ºã«ä¼ãˆã‚‹
   - ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€åŸå› ã¨è§£æ±ºç­–ã‚’åˆ†ã‹ã‚Šã‚„ã™ãèª¬æ˜

### ã‚³ãƒ¡ãƒ³ãƒˆã‚¹ã‚¿ã‚¤ãƒ«

```typescript
// âœ… Good - åˆå¿ƒè€…ãŒç†è§£ã§ãã‚‹
/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹é–¢æ•°
 *
 * å‡¦ç†ã®æµã‚Œ:
 * 1. ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å…¥åŠ›å†…å®¹ã‚’å–å¾—
 * 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ï¼ˆAPIçµŒç”±ï¼‰
 * 3. é€ä¿¡æˆåŠŸã—ãŸã‚‰å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
 * 4. ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
 */
const handleSubmit = async (data: FormData) => {
  // ...
};

// âŒ Bad - èª¬æ˜ãŒä¸ååˆ†
// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
const handleSubmit = async (data: FormData) => {
  // ...
};
```

### console.log ã®ä½¿ç”¨

ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ­ã‚°ã¯çµµæ–‡å­—ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§åˆ†é¡ï¼š

- `ğŸ”„` å‡¦ç†é–‹å§‹ãƒ»æ›´æ–°
- `âœ…` æˆåŠŸ
- `âŒ` ã‚¨ãƒ©ãƒ¼
- `ğŸ“¨` ãƒ‡ãƒ¼ã‚¿å—ä¿¡
- `ğŸ“¡` é€šä¿¡çŠ¶æ…‹
- `âš ï¸` è­¦å‘Š

ä¾‹:

```typescript
console.log("ğŸ”„ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡é–‹å§‹...");
console.log("âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æˆåŠŸ:", message);
console.error("âŒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡å¤±æ•—:", error);
```

## Development Commands

### åŸºæœ¬ã‚³ãƒãƒ³ãƒ‰

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev
# â†’ http://localhost:3000 ã§ã‚¢ãƒ—ãƒªã‚’ç¢ºèªã§ãã¾ã™

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰ï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ã®ãƒ“ãƒ«ãƒ‰ï¼‰
npm run build

# ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run start

# Lintå®Ÿè¡Œï¼ˆã‚³ãƒ¼ãƒ‰ã®å•é¡Œã‚’ãƒã‚§ãƒƒã‚¯ï¼‰
npm run lint
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ

```bash
# Prismaãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®å¤‰æ›´ã‚’è¨˜éŒ²ï¼‰
npx prisma migrate dev --name <migration_name>
# ä¾‹: npx prisma migrate dev --name add_user_avatar

# Prisma Clientå†ç”Ÿæˆï¼ˆTypeScriptå‹å®šç¾©ã‚’æœ€æ–°åŒ–ï¼‰
npx prisma generate

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèªï¼ˆç®¡ç†ç”»é¢ãŒé–‹ãï¼‰
npx prisma studio

# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥ï¼ˆé–‹ç™ºç”¨ã®ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆï¼‰
curl http://localhost:3000/api/seed
```

### ãƒ‡ãƒãƒƒã‚°ç”¨ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```bash
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ç¢ºèª
curl http://localhost:3000/api/debug/users

# ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ç¢ºèª
curl http://localhost:3000/api/debug/dashboard
```

## Architecture Overview

### å…¨ä½“æ§‹æˆ

ã“ã®ã‚¢ãƒ—ãƒªã¯ä»¥ä¸‹ã® 3 å±¤æ§‹é€ ã§å‹•ä½œã—ã¦ã„ã¾ã™ï¼š

```
[ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰]     Next.js + React
      â†• (HTTP/WebSocket)
[ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰]       Next.js API Routes
      â†• (Prisma ORM)
[ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹]       PostgreSQL (Supabase)
```

### èªè¨¼ãƒ•ãƒ­ãƒ¼ (Supabase Auth + Prisma)

ã“ã®ã‚¢ãƒ—ãƒªã¯ **2 ã¤ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ** ã‚’é€£æºã•ã›ã¦ã„ã¾ã™ï¼š

1. **Supabase Auth Database**: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ãƒ¡ãƒ¼ãƒ«èªè¨¼ãªã©ï¼‰
2. **Prisma Database (PostgreSQL)**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒãƒ£ãƒ³ãƒãƒ«ãªã©ï¼‰

**ãªãœ 2 ã¤ã«åˆ†ã‹ã‚Œã¦ã„ã‚‹ã®ã‹ï¼Ÿ**

- Supabase Auth: ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼æ©Ÿèƒ½ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ã€ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ãªã©ï¼‰ã‚’æä¾›
- Prisma Database: ã‚¢ãƒ—ãƒªå›ºæœ‰ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã€ãƒãƒ£ãƒ³ãƒãƒ«æƒ…å ±ãªã©ï¼‰ã‚’æŸ”è»Ÿã«ç®¡ç†

**é€£æºã®ä»•çµ„ã¿**:

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
   â†’ Supabase Auth ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆauthId ãŒç™ºè¡Œã•ã‚Œã‚‹ï¼‰

2. ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—æˆåŠŸå¾Œ
   â†’ Prisma Database ã® User ãƒ†ãƒ¼ãƒ–ãƒ«ã« authId ã‚’ä¿å­˜

3. ä»¥é™ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
   â†’ Supabase ã§ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ç¢ºèª
   â†’ authId ã‚’ä½¿ã£ã¦ Prisma ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
```

**é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«**:

- `src/lib/supabase/server.ts`: ã‚µãƒ¼ãƒãƒ¼å´ã®èªè¨¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆAPI å†…ã§ä½¿ç”¨ï¼‰
- `src/lib/supabase/client.ts`: ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®èªè¨¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã§ä½¿ç”¨ï¼‰
- `src/middleware.ts`: å…¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§èªè¨¼ãƒã‚§ãƒƒã‚¯ï¼ˆæœªãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å¼¾ãï¼‰
- `src/hooks/useAuth.ts`: React ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã®èªè¨¼çŠ¶æ…‹ç®¡ç†

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

**Supabase Realtime** ã‚’ä½¿ç”¨ã—ãŸ WebSocket ãƒ™ãƒ¼ã‚¹ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ã€‚

**ä»•çµ„ã¿ã®èª¬æ˜**:

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼AãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
   â†“
2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPostgreSQLï¼‰ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¿å­˜
   â†“
3. PostgreSQL ãŒã€Œæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚ŒãŸã‚ˆï¼ã€ã¨ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
   â†“
4. Supabase Realtime ãŒãã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚­ãƒ£ãƒƒãƒ
   â†“
5. WebSocketçµŒç”±ã§æ¥ç¶šä¸­ã®å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥
   â†“
6. ãƒ¦ãƒ¼ã‚¶ãƒ¼Bã®ç”»é¢ã«è‡ªå‹•çš„ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
```

**ä¸»ãªç‰¹å¾´**:

- **æ¥½è¦³çš„æ›´æ–°**: é€ä¿¡è€…ã¯é€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸç¬é–“ã«ç”»é¢æ›´æ–°ï¼ˆã‚µãƒ¼ãƒãƒ¼å¿œç­”ã‚’å¾…ãŸãªã„ï¼‰
- **ãƒãƒ«ãƒã‚¿ãƒ–åŒæœŸ**: åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¤‡æ•°ã‚¿ãƒ–ã‚’é–‹ã„ã¦ã„ã¦ã‚‚å…¨ã‚¿ãƒ–ã§åŒæœŸ
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ 1 ç§’ä»¥å†…ã«ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å±Šã

**å®Ÿè£…ã®ä¸­å¿ƒ**:

- `src/hooks/useRealtimeMessages.ts`: Realtime ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
- `src/hooks/useRealtimeDashboard.ts`: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çµ±è¨ˆã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

**ç„¡é™ãƒ«ãƒ¼ãƒ—å›é¿ç­–ï¼ˆé‡è¦ï¼‰**:
React ã® `useEffect` ã§ Realtime ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¨­å®šã™ã‚‹éš›ã€ä¾å­˜é…åˆ—ã®ç®¡ç†ã‚’èª¤ã‚‹ã¨ç„¡é™ãƒ«ãƒ¼ãƒ—ãŒç™ºç”Ÿã—ã¾ã™ã€‚

```typescript
// âŒ Bad - ç„¡é™ãƒ«ãƒ¼ãƒ—ç™ºç”Ÿ
useEffect(() => {
  const handleMessage = (payload) => {
    /* ... */
  };
  channel.on("INSERT", handleMessage).subscribe();
}, [messages]); // messages ãŒå¤‰ã‚ã‚‹ãŸã³ã«å†å®Ÿè¡Œ â†’ ç„¡é™ãƒ«ãƒ¼ãƒ—

// âœ… Good - useCallback ã§ãƒ¡ãƒ¢åŒ–
const handleMessage = useCallback((payload) => {
  setMessages((prev) => [...prev, payload.new]);
}, []); // ä¾å­˜ãªã— = é–¢æ•°ã¯å†ç”Ÿæˆã•ã‚Œãªã„

useEffect(() => {
  channel.on("INSERT", handleMessage).subscribe();
  return () => channel.unsubscribe(); // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¿…é ˆ
}, [channelId]); // channelId ãŒå¤‰ã‚ã£ãŸæ™‚ã ã‘å†å®Ÿè¡Œ
```

å‚è€ƒ: `troubleshooting/INFINITE_LOOP_TROUBLESHOOTING.md`

### API è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

ã™ã¹ã¦ã® API ã¯ `/src/app/api/` ä»¥ä¸‹ã«é…ç½®ã•ã‚Œã€Next.js 15 ã® App Router å½¢å¼ã§å®Ÿè£…ã€‚

**Next.js 15 ã®é‡è¦ãªå¤‰æ›´ç‚¹**:

```typescript
// âŒ Next.js 14 ä»¥å‰ã®æ›¸ãæ–¹ï¼ˆå‹•ã‹ãªã„ï¼‰
export async function GET(request: Request, { params }) {
  const { channelId } = params; // ã‚¨ãƒ©ãƒ¼ï¼
}

// âœ… Next.js 15 ã®æ›¸ãæ–¹ï¼ˆå¿…é ˆï¼‰
export async function GET(
  request: Request,
  context: { params: Promise<{ channelId: string }> }
) {
  const { channelId } = await context.params; // await ãŒå¿…è¦
  // ...
}
```

**ãªãœ await ãŒå¿…è¦ï¼Ÿ**
Next.js 15 ã§ã¯å‹•çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒéåŒæœŸã§è§£æ±ºã•ã‚Œã‚‹ãŸã‚ã€å¿…ãš `await` ã—ã¦ã‹ã‚‰ä½¿ç”¨ã—ã¾ã™ã€‚

**ä¸»è¦ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**:

- `GET /api/channels?userId=<id>`: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‚åŠ ã—ã¦ã„ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«ãƒ»DM ä¸€è¦§ã‚’å–å¾—
- `GET /api/messages/[channelId]`: ç‰¹å®šãƒãƒ£ãƒ³ãƒãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§å–å¾—
- `POST /api/messages/[channelId]`: æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
- `GET /api/dm/[partnerId]`: DM ãƒãƒ£ãƒ³ãƒãƒ«å–å¾—ï¼ˆãªã‘ã‚Œã°è‡ªå‹•ä½œæˆï¼‰
- `GET /api/dashboard`: çµ±è¨ˆæƒ…å ±å–å¾—ï¼ˆãƒãƒ£ãƒ³ãƒãƒ«æ•°ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ãªã©ï¼‰
- `GET /api/user/[userId]`: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—
- `POST /api/seed`: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆé–‹ç™ºç”¨ï¼‰

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ§‹é€ 

**ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

```
User (ãƒ¦ãƒ¼ã‚¶ãƒ¼)
â”œâ”€â”€ id: String (ä¸»ã‚­ãƒ¼)
â”œâ”€â”€ authId: String (Supabase Auth ã¨ã®é€£æºã‚­ãƒ¼ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„)
â”œâ”€â”€ name: String (ãƒ¦ãƒ¼ã‚¶ãƒ¼å)
â”œâ”€â”€ email: String (ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ¦ãƒ‹ãƒ¼ã‚¯åˆ¶ç´„)
â”œâ”€â”€ messages: Message[] (ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§)
â””â”€â”€ channels: ChannelMember[] (ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‚åŠ ã—ã¦ã„ã‚‹ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§)

Channel (ãƒãƒ£ãƒ³ãƒãƒ«/DM)
â”œâ”€â”€ id: String (ä¸»ã‚­ãƒ¼)
â”œâ”€â”€ name: String? (ãƒãƒ£ãƒ³ãƒãƒ«åã€DMã®å ´åˆã¯null)
â”œâ”€â”€ description: String? (èª¬æ˜ã€DMã®å ´åˆã¯null)
â”œâ”€â”€ type: String ("channel" ã¾ãŸã¯ "dm")
â”œâ”€â”€ members: ChannelMember[] (å‚åŠ ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§)
â””â”€â”€ messages: Message[] (ã“ã®ãƒãƒ£ãƒ³ãƒãƒ«å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§)

ChannelMember (ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ« - ã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã®ãƒãƒ£ãƒ³ãƒãƒ«ã«å‚åŠ ã—ã¦ã„ã‚‹ã‹)
â”œâ”€â”€ id: String (ä¸»ã‚­ãƒ¼)
â”œâ”€â”€ userId: String (å¤–éƒ¨ã‚­ãƒ¼ â†’ User)
â”œâ”€â”€ channelId: String (å¤–éƒ¨ã‚­ãƒ¼ â†’ Channel)
â””â”€â”€ @@unique([userId, channelId]) â† åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒã˜ãƒãƒ£ãƒ³ãƒãƒ«ã«é‡è¤‡å‚åŠ ã§ããªã„

Message (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸)
â”œâ”€â”€ id: String (ä¸»ã‚­ãƒ¼)
â”œâ”€â”€ content: String (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹)
â”œâ”€â”€ senderId: String (å¤–éƒ¨ã‚­ãƒ¼ â†’ User)
â”œâ”€â”€ channelId: String (å¤–éƒ¨ã‚­ãƒ¼ â†’ Channel)
â”œâ”€â”€ createdAt: DateTime (é€ä¿¡æ—¥æ™‚)
â””â”€â”€ updatedAt: DateTime (æ›´æ–°æ—¥æ™‚)

AiChat (AIä¼šè©±å±¥æ­´ - æœªå®Ÿè£…)
â”œâ”€â”€ id: String (ä¸»ã‚­ãƒ¼)
â”œâ”€â”€ userId: String (ä¼šè©±ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ID)
â”œâ”€â”€ message: String (ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸)
â”œâ”€â”€ response: String (AIã®å¿œç­”)
â””â”€â”€ createdAt: DateTime (ä¼šè©±æ—¥æ™‚)
```

**AI æ©Ÿèƒ½ã«ã¤ã„ã¦**:

- Prisma ã‚¹ã‚­ãƒ¼ãƒã« `AiChat` ãƒ¢ãƒ‡ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹
- `package.json` ã« `openai` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå«ã¾ã‚Œã¦ã„ã‚‹
- å®Ÿè£…ã¯ä»Šå¾Œäºˆå®šï¼ˆç¾åœ¨æœªä½¿ç”¨ï¼‰
- å°†æ¥çš„ã« OpenAI API ã‚’ä½¿ã£ãŸ AI ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ äºˆå®š

```

**DMï¼ˆãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ã®ç‰¹åˆ¥ãªæ‰±ã„**:

DM ã¯é€šå¸¸ã®ãƒãƒ£ãƒ³ãƒãƒ«ã¨åŒã˜ `Channel` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜ã•ã‚Œã¾ã™ãŒã€ä»¥ä¸‹ã®é•ã„ãŒã‚ã‚Šã¾ã™ï¼š

- `type` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ `"dm"`
- `name` ã¨ `description` ã¯ `null`
- å¿…ãš **2äººã®ãƒ¡ãƒ³ãƒãƒ¼** ã§æ§‹æˆã•ã‚Œã‚‹
- DM ä½œæˆæ™‚ã¯æ—¢å­˜ã® DM ãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ¤œç´¢ã—ã€å­˜åœ¨ã™ã‚Œã°ãã‚Œã‚’è¿”ã™ï¼ˆé‡è¤‡ä½œæˆã‚’é˜²ãï¼‰

**Cascade å‰Šé™¤ã®ä»•çµ„ã¿**:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ â†’ ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«ãƒ¡ãƒ³ãƒãƒ¼æƒ…å ±ã‚‚è‡ªå‹•å‰Šé™¤
- ãƒãƒ£ãƒ³ãƒãƒ«ã‚’å‰Šé™¤ â†’ ãã®ãƒãƒ£ãƒ³ãƒãƒ«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ãƒ¡ãƒ³ãƒãƒ¼æƒ…å ±ã‚‚è‡ªå‹•å‰Šé™¤

ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒè‡ªå‹•çš„ã«ä¿ãŸã‚Œã¾ã™ã€‚

### ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```

src/components/
â”œâ”€â”€ ui/ # shadcn/ui åŸºæœ¬ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆãƒœã‚¿ãƒ³ã€å…¥åŠ›æ¬„ãªã©ï¼‰
â”‚ â”œâ”€â”€ button.tsx
â”‚ â”œâ”€â”€ input.tsx
â”‚ â”œâ”€â”€ card.tsx
â”‚ â””â”€â”€ ... (ãã®ä»– UI ãƒ‘ãƒ¼ãƒ„)
â”‚
â”œâ”€â”€ workspace/ # ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆé–¢é€£
â”‚ â”œâ”€â”€ appLogo.tsx # ã‚¢ãƒ—ãƒªã®ãƒ­ã‚´è¡¨ç¤º
â”‚ â”œâ”€â”€ channelList.tsx # ãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§
â”‚ â”œâ”€â”€ directMessageList.tsx # DM ä¸€è¦§
â”‚ â”œâ”€â”€ userManagement.tsx # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆæ‹›å¾…ãªã©ï¼‰
â”‚ â””â”€â”€ userProfileBar.tsx # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³
â”‚
â”œâ”€â”€ channel/ # ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
â”‚ â”œâ”€â”€ channelHeader.tsx # ãƒãƒ£ãƒ³ãƒãƒ«ä¸Šéƒ¨ï¼ˆåå‰ã€èª¬æ˜ã€é€šè©±ãƒœã‚¿ãƒ³ï¼‰
â”‚ â”œâ”€â”€ messageView.tsx # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§è¡¨ç¤º
â”‚ â””â”€â”€ messageForm.tsx # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›ãƒ»é€ä¿¡ãƒ•ã‚©ãƒ¼ãƒ 
â”‚
â””â”€â”€ dm/ # DM å°‚ç”¨
â””â”€â”€ dmHeader.tsx # DM ç›¸æ‰‹ã®æƒ…å ±ãƒ»é€šè©±ãƒœã‚¿ãƒ³

```

**ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆéšå±¤ã®èª¬æ˜**:
```

src/app/layout.tsx (ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ)
â””â”€â”€ å…¨ãƒšãƒ¼ã‚¸å…±é€šã®è¨­å®šï¼ˆãƒ•ã‚©ãƒ³ãƒˆã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãªã©ï¼‰

    src/app/workspace/layout.tsx (èªè¨¼å¿…é ˆã‚¨ãƒªã‚¢)
    â””â”€â”€ ã‚µã‚¤ãƒ‰ãƒãƒ¼ä»˜ããƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ãªã„ã¨ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„ï¼‰

        src/app/workspace/channel/[channelId]/page.tsx
        â””â”€â”€ å€‹åˆ¥ãƒãƒ£ãƒƒãƒˆãƒšãƒ¼ã‚¸ï¼ˆå‹•çš„ãƒ«ãƒ¼ãƒˆï¼‰

        src/app/workspace/dm/[userId]/page.tsx
        â””â”€â”€ DM ãƒšãƒ¼ã‚¸ï¼ˆå‹•çš„ãƒ«ãƒ¼ãƒˆï¼‰

````

**ãªãœã“ã®æ§‹é€ ï¼Ÿ**
- èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸ã¯ `workspace/layout.tsx` é…ä¸‹ã«é…ç½®
- ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã‚³ãƒ¼ãƒ‰ã‚’1ç®‡æ‰€ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãŒæ¥½ã«ãªã‚‹
- ãƒãƒ£ãƒ³ãƒãƒ«/DM ãƒšãƒ¼ã‚¸ã¯ URL ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§åˆ‡ã‚Šæ›¿ãˆï¼ˆãƒšãƒ¼ã‚¸é·ç§»ãŒé«˜é€Ÿï¼‰

### çŠ¶æ…‹ç®¡ç†æˆ¦ç•¥

ç¾åœ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®çŠ¶æ…‹ç®¡ç†æ–¹æ³•ï¼š

| ãƒ‡ãƒ¼ã‚¿ã®ç¨®é¡ | ç®¡ç†æ–¹æ³• | ç†ç”± |
|------------|---------|------|
| **ã‚µãƒ¼ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿** (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ãƒãƒ£ãƒ³ãƒãƒ«ãªã©) | React `useState` + `useEffect` | ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„ |
| **èªè¨¼çŠ¶æ…‹** | ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ (`useAuth`) | èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã‚’1ç®‡æ‰€ã«é›†ç´„ |
| **ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›** | React Hook Form + Zod | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨å‹å®‰å…¨æ€§ |
| **ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹** | æœªä½¿ç”¨ (å°†æ¥çš„ã« Zustand å°å…¥äºˆå®š) | ç¾çŠ¶ã¯å¿…è¦æ€§ãŒä½ã„ |

**å°†æ¥ã®æ‹¡å¼µè¨ˆç”»**:
- **SWR**: ã‚µãƒ¼ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»è‡ªå‹•å†æ¤œè¨¼ï¼ˆãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆæ™‚ã®é«˜é€ŸåŒ–ï¼‰
- **Zustand**: è¤‡æ•°ãƒšãƒ¼ã‚¸ã§å…±æœ‰ã™ã‚‹çŠ¶æ…‹ï¼ˆä¾‹: é€šçŸ¥ãƒãƒƒã‚¸ã®æœªèª­æ•°ï¼‰

## Important Implementation Details

### Prisma Client ã®åˆæœŸåŒ–

`src/lib/prisma.ts` ã§ **Singleton ãƒ‘ã‚¿ãƒ¼ãƒ³** ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

**ãªãœ Singleton ãŒå¿…è¦ï¼Ÿ**
é–‹ç™ºç’°å¢ƒã§ã¯ Next.js ã® Hot Reloadï¼ˆã‚³ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®è‡ªå‹•ãƒªãƒ­ãƒ¼ãƒ‰ï¼‰ã«ã‚ˆã‚Šã€`PrismaClient` ãŒä½•åº¦ã‚‚ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæ•°ãŒä¸Šé™ã«é”ã—ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

Singleton ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã¯ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«1ã¤ã ã‘ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä¿æŒã™ã‚‹ã“ã¨ã§ã€ã“ã®å•é¡Œã‚’å›é¿ã—ã¦ã„ã¾ã™ã€‚

```typescript
// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã§1ã¤ã ã‘ä¿æŒ
const globalForPrisma = global as unknown as { prisma: PrismaClient };

export const prisma = globalForPrisma.prisma || new PrismaClient();

if (process.env.NODE_ENV !== 'production') {
  globalForPrisma.prisma = prisma;
}
````

### Supabase Realtime ã®è¨­å®š

**å¿…é ˆè¨­å®š** (Supabase Dashboard ã§å®Ÿæ–½):

1. **Database â†’ Replication â†’ Publications**

   - `supabase_realtime` ã¨ã„ã† Publication ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
   - ã“ã‚Œã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å¤‰æ›´ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é…ä¿¡ã™ã‚‹ãŸã‚ã®è¨­å®š

2. **Message ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ Publication ã«è¿½åŠ **

   - `Message` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã‚‹
   - ã“ã‚Œã«ã‚ˆã‚Šã€æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ INSERT ã•ã‚ŒãŸæ™‚ã«ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºè¡Œã•ã‚Œã‚‹

3. **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**
   ```bash
   NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
   NEXT_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
   ```

**è¨­å®šãŒæ­£ã—ã„ã‹ç¢ºèªã™ã‚‹æ–¹æ³•**:

```typescript
// ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ä»¥ä¸‹ã®ãƒ­ã‚°ã‚’ç¢ºèª
âœ… Realtimeã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æˆåŠŸ  // OK
âŒ Realtimeãƒãƒ£ãƒ³ãƒãƒ«ã‚¨ãƒ©ãƒ¼        // NG - è¨­å®šã‚’è¦‹ç›´ã™
```

è©³ç´°: `troubleshooting/REALTIME_TROUBLESHOOTING.md`

### ç’°å¢ƒå¤‰æ•°

`.env.local` ã«ä»¥ä¸‹ã‚’è¨­å®šï¼ˆ`.env.local` ã¯ `.gitignore` æ¸ˆã¿ã€GitHub ã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚Œãªã„ï¼‰:

```bash
# Supabaseï¼ˆèªè¨¼ãƒ»Realtimeç”¨ï¼‰
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJxxxxxxxxxxxx

# Databaseï¼ˆPrismaç”¨ï¼‰
# Supabase ã® Settings â†’ Database â†’ Connection string ã‹ã‚‰å–å¾—
DATABASE_URL=postgresql://postgres:[PASSWORD]@[HOST]:5432/postgres?pgbouncer=true  # Transaction ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰
DIRECT_URL=postgresql://postgres:[PASSWORD]@[HOST]:5432/postgres                   # Session ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ï¼‰
```

**ãªãœ DATABASE_URL ã¨ DIRECT_URL ã® 2 ã¤ãŒå¿…è¦ï¼Ÿ**

- `DATABASE_URL`: é€šå¸¸ã®ã‚¯ã‚¨ãƒªå®Ÿè¡Œç”¨ï¼ˆPgBouncer çµŒç”±ã§é«˜é€ŸåŒ–ï¼‰
- `DIRECT_URL`: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œç”¨ï¼ˆç›´æ¥æ¥ç¶šãŒå¿…è¦ï¼‰

### èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã®å‹•ä½œ

`src/middleware.ts` ã¯ **å…¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§è‡ªå‹•å®Ÿè¡Œ** ã•ã‚Œã¾ã™ã€‚

**ä¿è­·ã•ã‚Œã‚‹ãƒ‘ã‚¹**:

- `/workspace/*`: ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆ
- ãã®ä»–ã®èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸

**ä¿è­·ã•ã‚Œãªã„ãƒ‘ã‚¹**:

- `/login`, `/signup`: ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸è‡ªä½“
- `/auth/callback`: èªè¨¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
- `/_next/static/*`: Next.js ã®é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
- ç”»åƒãƒ•ã‚¡ã‚¤ãƒ« (`.png`, `.jpg`, etc.)

**å‹•ä½œã®æµã‚Œ**:

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ /workspace ã«ã‚¢ã‚¯ã‚»ã‚¹
   â†“
2. middleware.ts ãŒå®Ÿè¡Œã•ã‚Œã‚‹
   â†“
3. Supabase ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
   â†“
4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒç„¡åŠ¹ â†’ /login ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
   ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœ‰åŠ¹ â†’ ãã®ã¾ã¾ãƒšãƒ¼ã‚¸è¡¨ç¤º
```

### ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ãƒ•ãƒ­ãƒ¼ï¼ˆè©³ç´°ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¦ã‹ã‚‰ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å±Šãã¾ã§ã®æµã‚Œï¼š

```
[ãƒ¦ãƒ¼ã‚¶ãƒ¼A] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ› â†’ é€ä¿¡ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
   â†“
[messageForm.tsx]
   1. ãƒ•ã‚©ãƒ¼ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç©ºæ–‡å­—ãƒã‚§ãƒƒã‚¯ï¼‰
   2. æ¥½è¦³çš„æ›´æ–°: setMessages(prev => [...prev, newMessage])
      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼Aã®ç”»é¢ã«å³åº§ã«è¡¨ç¤º
   3. API ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: POST /api/messages/[channelId]
   â†“
[API Route] src/app/api/messages/[channelId]/route.ts
   1. Supabase ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ç¢ºèª
   2. Prisma ã§ Message ãƒ†ãƒ¼ãƒ–ãƒ«ã« INSERT
   3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹è¿”å´: { success: true, message: {...} }
   â†“
[PostgreSQL Database]
   1. Message ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ–°ã—ã„è¡Œã‚’è¿½åŠ 
   2. Realtime ã« INSERT ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œ
   â†“
[Supabase Realtime]
   1. INSERT ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œçŸ¥
   2. WebSocket çµŒç”±ã§å…¨æ¥ç¶šã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€šçŸ¥
   â†“
[ãƒ¦ãƒ¼ã‚¶ãƒ¼B] useRealtimeMessages ãƒ•ãƒƒã‚¯
   1. INSERT ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡
   2. payload ã‹ã‚‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ãƒ¼ã‚¿å–å¾—
   3. é€ä¿¡è€…æƒ…å ±ã‚’ API ã§å–å¾—: GET /api/user/[userId]
   4. setMessages(prev => [...prev, newMessageWithSender])
      â†’ ãƒ¦ãƒ¼ã‚¶ãƒ¼Bã®ç”»é¢ã«è‡ªå‹•è¡¨ç¤º
```

**ãƒã‚¤ãƒ³ãƒˆ**:

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ A ã¯ã€Œé€ä¿¡ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸç¬é–“ã€ã«ç”»é¢æ›´æ–°ï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ B ã¯ã€Œ1 ç§’ä»¥å†…ã€ã«è‡ªå‹•ã§ç”»é¢æ›´æ–°ï¼ˆRealtimeï¼‰
- ã‚¨ãƒ©ãƒ¼ãŒèµ·ããŸå ´åˆã®ã¿ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ A ã«ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º

## Known Issues and Limitations

ç¾åœ¨ã®åˆ¶é™äº‹é …ã¨ä»Šå¾Œã®å®Ÿè£…äºˆå®šï¼š

1. **Edge Runtime éå¯¾å¿œ**

   - **ç†ç”±**: Prisma ãŒ Edge Runtime ã§å‹•ä½œã—ãªã„
   - **å½±éŸ¿**: ã™ã¹ã¦ã® API ã¯ Node.js Runtime ã‚’ä½¿ç”¨
   - **å¯¾ç­–**: ç¾çŠ¶ã¯ç‰¹ã«ãªã—ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¸ã®å½±éŸ¿ã¯è»½å¾®ï¼‰

2. **ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰æœªå®Ÿè£…**

   - **ç¾çŠ¶**: ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å¯¾å¿œ
   - **ä»Šå¾Œ**: ç”»åƒãƒ»PDF ãªã©ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’è¿½åŠ äºˆå®š

3. **ã‚¹ãƒ¬ãƒƒãƒ‰æ©Ÿèƒ½æœªå®Ÿè£…**

   - **ç¾çŠ¶**: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¸ã®è¿”ä¿¡æ©Ÿèƒ½ãªã—
   - **ä»Šå¾Œ**: Slack é¢¨ã®ã‚¹ãƒ¬ãƒƒãƒ‰æ©Ÿèƒ½ã‚’è¿½åŠ äºˆå®š

4. **é€šçŸ¥æ©Ÿèƒ½æœªå®Ÿè£…**

   - **ç¾çŠ¶**: ãƒ–ãƒ©ã‚¦ã‚¶é€šçŸ¥ãƒ»ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ãªã—
   - **ä»Šå¾Œ**: æ–°ç€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€šçŸ¥æ©Ÿèƒ½ã‚’è¿½åŠ äºˆå®š

5. **ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æœªå®Ÿè£…**

   - **ç¾çŠ¶**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³/ã‚ªãƒ•ãƒ©ã‚¤ãƒ³çŠ¶æ…‹ãŒåˆ†ã‹ã‚‰ãªã„
   - **ä»Šå¾Œ**: Supabase Presence ã‚’ä½¿ã£ãŸå®Ÿè£…ã‚’æ¤œè¨

6. **AI ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½æœªå®Ÿè£…**
   - **ç¾çŠ¶**: `AiChat` ãƒ¢ãƒ‡ãƒ«ã¨ OpenAI ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯å­˜åœ¨ã™ã‚‹ãŒæœªå®Ÿè£…
   - **ä»Šå¾Œ**: OpenAI API ã‚’ä½¿ã£ãŸ AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ äºˆå®š

## Troubleshooting

è©³ç´°ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰ï¼š

- `troubleshooting/REALTIME_TROUBLESHOOTING.md`: Supabase Realtime è¨­å®šãƒ»æ¥ç¶šã‚¨ãƒ©ãƒ¼
- `troubleshooting/INFINITE_LOOP_TROUBLESHOOTING.md`: React useEffect ç„¡é™ãƒ«ãƒ¼ãƒ—è§£æ±ºæ³•
- `troubleshooting/README.md`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹

**ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼**:

| ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸                                           | åŸå›                             | è§£æ±ºæ–¹æ³•                                       |
| ---------------------------------------------------------- | ------------------------------- | ---------------------------------------------- |
| `PrismaClientInitializationError`                          | DATABASE_URL ãŒæ­£ã—ããªã„       | `.env.local` ã‚’ç¢ºèª                            |
| `CHANNEL_ERROR` (Realtime)                                 | Publication è¨­å®šãŒä¸è¶³          | Supabase Dashboard ã§è¨­å®šç¢ºèª                  |
| `Invariant: cookies() expects to have requestAsyncStorage` | middleware ã§ã‚¯ãƒƒã‚­ãƒ¼æ“ä½œã‚¨ãƒ©ãƒ¼ | `src/lib/supabase/server.ts` ã® try-catch ç¢ºèª |
| `params is not a Promise`                                  | Next.js 15 å½¢å¼ã«æœªå¯¾å¿œ         | `await context.params` ã«ä¿®æ­£                  |

## Development Guidelines

### ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«

1. **æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆã‚’ç©æ¥µçš„ã«ä½¿ã†**

   - ã™ã¹ã¦ã®é–¢æ•°ãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«èª¬æ˜ã‚’è¨˜è¼‰
   - ã€Œãªãœã“ã®ã‚³ãƒ¼ãƒ‰ãŒå¿…è¦ãªã®ã‹ã€ã‚’æ˜è¨˜

2. **console.log ã¯åˆ†é¡ã™ã‚‹**

   ```typescript
   console.log("ğŸ”„ å‡¦ç†é–‹å§‹");
   console.log("âœ… æˆåŠŸ");
   console.error("âŒ ã‚¨ãƒ©ãƒ¼");
   console.log("ğŸ“¨ ãƒ‡ãƒ¼ã‚¿å—ä¿¡");
   ```

3. **Prisma ã‚¯ã‚¨ãƒªã¯å‹å®‰å…¨ã«**

   ```typescript
   // âœ… Good - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…ˆã‚‚å‹å®šç¾©ã•ã‚Œã‚‹
   const channel = await prisma.channel.findUnique({
     where: { id: channelId },
     include: {
       members: { include: { user: true } },
       messages: { include: { sender: true } },
     },
   });

   // âŒ Bad - å‹ãŒä¸å®Œå…¨
   const channel = await prisma.channel.findUnique({
     where: { id: channelId },
   });
   ```

### æ–°ã—ã„ãƒãƒ£ãƒ³ãƒãƒ«/DM ãƒšãƒ¼ã‚¸è¿½åŠ æ™‚

ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã‚’æŒã¤ãƒšãƒ¼ã‚¸ã‚’æ–°è¦ä½œæˆã™ã‚‹å ´åˆã®æ‰‹é †ï¼š

1. **useRealtimeMessages ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨**

   ```typescript
   const { messages, addMessage } = useRealtimeMessages({
     channelId,
     initialMessages,
   });
   ```

2. **åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ SSR ã§å–å¾—**

   ```typescript
   // ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…
   const response = await fetch(`/api/messages/${channelId}`);
   const initialMessages = await response.json();
   ```

   **ç†ç”±**: SEO å¯¾ç­– + åˆå›èª­ã¿è¾¼ã¿é«˜é€ŸåŒ–

3. **channelId å¤‰æ›´æ™‚ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆ**

   ```typescript
   useEffect(() => {
     setMessages(initialMessages);
   }, [channelId]); // channelId ãŒå¤‰ã‚ã£ãŸã‚‰å†è¨­å®š
   ```

4. **ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—é–¢æ•°ã§å¿…ãš Unsubscribe**

   ```typescript
   useEffect(() => {
     const channel = supabase.channel("...");
     channel.subscribe();

     return () => {
       supabase.removeChannel(channel); // å¿…é ˆ
     };
   }, [channelId]);
   ```

### API ãƒ«ãƒ¼ãƒˆè¿½åŠ æ™‚

æ–°ã—ã„ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆï¼š

1. **Next.js 15 å½¢å¼ã§ params ã‚’ await**

   ```typescript
   export async function GET(
     request: Request,
     context: { params: Promise<{ id: string }> }
   ) {
     const { id } = await context.params;
     // ...
   }
   ```

2. **Prisma ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯å…±é€šã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ç”¨**

   ```typescript
   import { prisma } from "@/lib/prisma";

   const data = await prisma.message.findMany();
   ```

3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã§é©åˆ‡ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™**

   ```typescript
   try {
     const data = await prisma.message.create({...});
     return NextResponse.json({ success: true, data });
   } catch (error) {
     console.error('âŒ ã‚¨ãƒ©ãƒ¼:', error);
     return NextResponse.json(
       { success: false, error: 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ' },
       { status: 500 }
     );
   }
   ```

4. **èªè¨¼ãŒå¿…è¦ãªå ´åˆã¯ Supabase ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—**

   ```typescript
   import { createClient } from "@/lib/supabase/server";

   const supabase = await createClient();
   const {
     data: { user },
     error,
   } = await supabase.auth.getUser();

   if (error || !user) {
     return NextResponse.json(
       { success: false, error: "èªè¨¼ãŒå¿…è¦ã§ã™" },
       { status: 401 }
     );
   }
   ```

### æ–°ã—ã„ UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¿½åŠ æ™‚

shadcn/ui ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼š

```bash
# shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npx shadcn@latest add <component-name>
# ä¾‹: npx shadcn@latest add toast
```

ã‚«ã‚¹ã‚¿ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆï¼š

```typescript
/**
 * ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚«ãƒ¼ãƒ‰
 *
 * ç”¨é€”: ãƒãƒ£ãƒƒãƒˆç”»é¢ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’1ä»¶è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ã‚«ãƒ¼ãƒ‰
 *
 * Props:
 * - message: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆé€ä¿¡è€…ã€å†…å®¹ã€æ—¥æ™‚ã‚’å«ã‚€ï¼‰
 * - isOwnMessage: è‡ªåˆ†ãŒé€ä¿¡ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã©ã†ã‹ï¼ˆå³å¯„ã›/å·¦å¯„ã›ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ï¼‰
 */
export function MessageCard({ message, isOwnMessage }: MessageCardProps) {
  // ...
}
```

## Reference Repository

å‚è€ƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: `/Users/Uni/Uni_MacBookAir/STUDYing/å’æ¥­åˆ¶ä½œâ€ãƒãƒ£ãƒƒãƒˆã‚¢ãƒ—ãƒª/ã€è¦‹æœ¬ã€‘GitHubã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰/studying-tech-chat-app-main`

**æ³¨æ„**: å‚è€ƒã«ã—ã¦ã„ã‚‹ãŒã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ç‹¬è‡ªã®å®Ÿè£…ãƒ»æ”¹å–„ã‚’å«ã¿ã¾ã™ã€‚å®Œå…¨ãªã‚³ãƒ”ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

## Completed Features (å®Œæˆæ¸ˆã¿æ©Ÿèƒ½)

### èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

- âœ… Supabase Auth ã«ã‚ˆã‚‹ãƒ¡ãƒ¼ãƒ«èªè¨¼
- âœ… ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ç”»é¢
- âœ… ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼‰
- âœ… Supabase â†” Prisma ã®é€£æºï¼ˆauthId ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆ

- âœ… ãƒãƒ£ãƒ³ãƒãƒ«ãƒãƒ£ãƒƒãƒˆ
- âœ… ãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (1 å¯¾ 1)
- âœ… Supabase Realtime ã«ã‚ˆã‚‹å³æ™‚é…ä¿¡
- âœ… æ¥½è¦³çš„æ›´æ–°ï¼ˆé€ä¿¡è€…å´ï¼‰
- âœ… ãƒãƒ«ãƒã‚¿ãƒ–åŒæœŸ

### UI/UX

- âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ãƒ»ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼‰
- âœ… ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒãƒ£ãƒ³ãƒãƒ«ä¸€è¦§ãƒ»DM ä¸€è¦§ï¼‰
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤º
- âœ… ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

- âœ… Prisma ORM å®Œå…¨çµ±åˆ
- âœ… PostgreSQL (Supabase) æ¥ç¶š
- âœ… ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆUser, Channel, Message, ChannelMemberï¼‰
- âœ… Cascade å‰Šé™¤è¨­å®š

## Next Tasks (æ¬¡ã®ã‚¿ã‚¹ã‚¯)

å„ªå…ˆé †ä½é †ã«è¨˜è¼‰ï¼ˆè©³ç´°ã¯ CONTEXT*HANDOVER*\*.md ã‚’å‚ç…§ï¼‰:

1. **UI/UX æ”¹å–„**

   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡æ™‚ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å‘ä¸Š
   - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—è¡¨ç¤ºæ”¹å–„
   - æ—¢èª­ãƒ»æœªèª­çŠ¶æ…‹è¡¨ç¤º

2. **è¿½åŠ æ©Ÿèƒ½**

   - ãƒ•ã‚¡ã‚¤ãƒ«å…±æœ‰ï¼ˆç”»åƒãƒ»æ–‡æ›¸ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼‰
   - ã‚¹ãƒ¬ãƒƒãƒ‰æ©Ÿèƒ½ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¸ã®è¿”ä¿¡ï¼‰
   - æ¤œç´¢æ©Ÿèƒ½ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ï¼‰
   - ãƒãƒ£ãƒ³ãƒãƒ«ç®¡ç†ï¼ˆä½œæˆãƒ»ç·¨é›†ãƒ»å‰Šé™¤ï¼‰

3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
   - SWR å°å…¥ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»è‡ªå‹•å†æ¤œè¨¼ï¼‰
   - ä»®æƒ³ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆå¤§é‡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å¯¾å¿œï¼‰
   - ç”»åƒé…å»¶èª­ã¿è¾¼ã¿
